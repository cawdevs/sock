<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOCK PUPPETS</title>

     <style>
      html {
           background: linear-gradient(45deg, lime,darkgreen);
             }
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(0deg, lime,darkgreen);
        }
   
        .container {

            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 30px;
        }

        .boton-conectar {
            background-color: silver;
            color: black;
            border: 2px solid silver;
            border-radius: 20px;
            padding: 5px 10px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            display:inline-block;
            margin-left: 40px;
        }

        .boton-conectar:hover {
            background-color: lime;
            border-color: lime;
            display:inline-block;

        }
     
    </style>

<style>
    button {        
        
        cursor: pointer;
        transition: transform 0.2s ease-in-out, background-color 0.4s ease;
    }
    button:active {
        background-color: darkgray;
        transform: scale(0.85);
    }
</style>





     <style>
.gallery_toolbar {
  padding: 1rem;
  display: flex;
  grid-template-columns: repeat(20, 25vw);
  grid-template-rows: 1fr;
  grid-column-gap: 1rem;
  grid-row-gap: 1rem;
  overflow: scroll;

 
  scroll-snap-type: both mandatory;
  scroll-padding: 1rem;

  background-color: white;
}

.active {
  scroll-snap-type: unset;
}
</style>




<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

<!-- Agrega el siguiente script para cargar la biblioteca desde un CDN -->
<script src="https://cdn.jsdelivr.net/gh/davidshimjs/qrcodejs/qrcode.min.js"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js"></script>

<!-- para usar numeros grandisimos en javascript-->

<script src="https://cdn.jsdelivr.net/npm/bignumber.js@9.1.1/bignumber.min.js"></script>





</head>


<body>
<script src="messageDirect.js"></script>
<script src="stakingpool.js"></script>
<script src="responses.js"></script>

<script src="FreeDistributionSockMatic.js"></script>

<script src="MintNFTUsernameandPuppet.js"></script>
<script src="FindAndFilter.js"></script>
<script src="NFTUsername_profile.js"></script>
<script src="sendTokens.js"></script>
<script src="followControl.js"></script>
<script src="postPublication.js"></script>


<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>



 

<br>
 


<!--
 <center>  <div>
    <img src="images/sock_logo.SVG" alt="My svg_logo" width="45" class="img-circle" style="transform: rotate(0deg); display: inline-block; margin-left: 10px;border: 2px solid white;">
   
    <h3 style="display: inline-block; margin: 0; vertical-align: middle; margin-left: 10px;"><font color="white"><i> SockPuppets </i></font> </h3>
<i class="fa-brands fa-github" style="color: #FFD43B;"></i>

     <a  href="whiteDocument.html" target="_blank" ><img src="images/icons/document_icon.SVG" alt="My svg_logo" width="25"  style="transform: rotate(0deg); display: inline-block; margin-left: 20px; "></a>

    

     <a href="https://github.com/cawdevs" target="_blank" rel="noopener noreferrer"> <img src="images/logoG.SVG" alt="My svg_logo" width="25"  style="transform: rotate(0deg); display: inline-block; margin-left: 20px; ">
     </a>

     <a href="https://x.com/puppets_token" target="_blank" rel="noopener noreferrer"> <img src="images/logoX.svg" alt="My svg_logo" width="25"  style="transform: rotate(0deg); display: inline-block; margin-left: 20px; ">
     </a>

      	
    <button class="boton-conectar" id="btn-conectar" onclick="conectarMetaMask()" style="display: inline-block; margin-left: 20px;">Conect</button>



 </div></center>


-->






    <center>

    
 

  <h4>

<div style="display: flex; justify-content: center; align-items: center; gap: 30px;">
     
   

    <!-- Dirección de la billetera -->
    <div id="addres-wallet" style="color: white;"></div>
    
    <!-- Generar código QR -->
    <a href="#" data-toggle="modal" data-target="#myModalQR" onclick="generarCodigoQR()">
        <span class="glyphicon glyphicon-qrcode" style="color: white;"></span>
    </a>
    
    <!-- Copiar clave -->
    <a href="#" id="btn-copy-key" onclick="myFunctionbtc()">
        <span class="glyphicon glyphicon-duplicate" style="color: white;"></span>
    </a>

    <!-- Cerrar sesión -->
    <a href="#" onclick="logout()" style="color: white;">
        <span class="glyphicon glyphicon-off"  title="Salir"> </span>
    </a>
    
   
   
</div>


      
       

   </h4>




 </center> 

 

<br>

<div class="container-fluid">
<div class="row">

   <div class="col-sm-1"> 
   </div>

          
 <div class="col-sm-6">   





<nav class="navbar navbar-inverse" role="navigation" style="border: 2px solid white; border-radius: 20px; background: black; position: relative; height: 50px;"> <!-- Ajusta la altura de la barra aquí -->
    <div class="container-fluid" style="display: flex; align-items: center; justify-content: flex-start; height: 100%;">

        <!-- Selector de NFTs a 120px del borde izquierdo -->
        <div style="margin-left: 110px; display: flex; align-items: center;">
            <select id="selector_NFTs" class="form-control" placeholder="Username" style="border: 2px solid lime; border-radius: 10px; font-size: 24px; height: auto; width: 150px;"></select>
        </div>

        <!-- Icono de publicación -->
        <div style="display: flex; align-items: center; margin-left: 10px;">
            <a href="#" data-toggle="modal" data-target="#myModal">
                <span class="glyphicon glyphicon-plus-sign" style="color: lime; font-size: 30px; vertical-align: middle;"></span>
            </a>
        </div>


      
     

    </div>

    <!-- Imagen NFT sobrepuesta a la izquierda -->

     <div  style="border: 2px solid white; border-radius: 50%; position: absolute; top: 50%; left: 10px; transform: translateY(-50%); width: 80px; height: 80px;">
        <div id="NFT_image-container" style=" width:80px;  height: 80px;"> </div>
    </div>


    
</nav>



                  
       <!--   
       <div class="well" style="border: 2px solid lime; background: black; border-radius: 20px;">  -->
                    <!--<div style="background: red; width:90px; height: 50px; display: inline-block; margin-top: 50px;"></div>  -->

                    <h5> 
                      <p style="display:inline-block;"><img src="images/icons/sock_coin.SVG" alt="My svg_logo" width="30"  style="transform: rotate(0deg); display: inline-block; margin-left: 20px; "></p>
     <div style="display:inline-block;" id="saldo_CAW"><font color="lime"></font></div>

     <div style="display:inline-block;" > </div>
     <div style="display:inline-block;" > </div>
     <p style="display:inline-block;"><img src="images/icons/matic_coin.SVG" alt="My svg_logo" width="30"  style="transform: rotate(0deg); display: inline-block; margin-left: 20px; "></p>
     <div style="display:inline-block;" id="saldo_ETH"><font color="white "></font></div>

     <div style="display:inline-block;" > </div>
     <div style="display:inline-block;" > </div>
     <div style="display:inline-block;" id="saldo_USD"><font color="white "></font></div>
     <div style="display:inline-block;" > </div>
     <a href="#" style="display:inline-block;" id="btn-obtener-saldo"><font color="black"><span class="glyphicon glyphicon-refresh"></span></font></a>
     
     <div style="display:inline-block;" > </div>
      <div style="display:inline-block;" > </div>
     <a href="#" style="display:inline-block;  margin-left: 20px;  font-size: 24px;" id="btn-enviar-saldo" onclick="modal_enviarTokens()"><font color="lime"><span class="glyphicon glyphicon-send"></span></font></a>

     <div style="display:inline-block;" > </div>

      

     

         
<!--
           <div class="input-group">                 

                  <input type="text" id="text-address-to-send-ETH" class="form-control" placeholder="enter a 0x.. to send ETH" style="border: 2px solid black; border-radius: 10px; width: 100%; height: 40px; margin-right: 10px;">
            
                  <div class="input-group-btn">
                       <button id="btn-send-ETH-wallet" class="btn btn-default" onclick="sendETHtowallet()" style="background-color: black; color: white; border: 2px solid lime; border-radius: 20px; height: 40px;">
                         <span class="glyphicon glyphicon-send"></span>
                       </button>  

                        <button class="boton-conectar" id="btn-caw-free" onclick="tokensFree('SOCK')" style="display: inline-block; margin-left: 10px;">2M SOCK FREE</button>   
                           
                  </div>
           </div>

  -->
 

     
    </h5>




 


  
 
  <ul class="gallery_toolbar" style="background-color: lightgray; border: 2px solid lime; border-radius: 20px;">     
   
       <a href="#" data-toggle="modal" data-target="#myModal_publication" onclick="createPublicationElements() " style=" margin-left: 15px;">
                <img  id="image-post" src="images/icons/post_icon.SVG" alt="post" width="45">
       </a>

       
       <a data-toggle="tab" href="#home" style=" margin-left: 15px;">  <img  id="image-home" src="images/icons/home_icon.SVG" alt="home" width="45"></a> 
       
       <a data-toggle="tab" href="#menu1" style=" margin-left: 15px;">  <img  id="image-home" src="images/icons/profile_icon.SVG" alt="home" width="45"> </a>
       
       <a data-toggle="tab" href="#menu2" style=" margin-left: 15px;">  <img  id="image-cars" src="images/icons/publication_icon.SVG" alt="home" width="45"> </a>
       
       <a data-toggle="tab" href="#menu_mensaje" style=" margin-left: 15px;">  <img  id="image-food" src="images/icons/message_icon.SVG" alt="home" width="45"> </a>
       
       <a data-toggle="tab" href="#menu_play" style=" margin-left: 15px;">  <img  id="image-market" src="images/icons/gamefi_icon.SVG" alt="home" width="45"> </a>
       
       <!--                   
       <a data-toggle="tab" href="#menu_play_to_earn" style=" margin-left: 15px;">  <img  id="image-mymarket" src="images/icons/gamefi_icon.SVG" alt="mymarket" width="45"> </a>
       -->
       <a data-toggle="tab" href="#menu_transfer" style=" margin-left: 15px;">  <img  id="image-service" src="images/icons/swap_icon.SVG" alt="home" width="45"> </a>

        <a data-toggle="tab" href="#menu_staking" style=" margin-left: 15px;">  <img  id="image-service" src="images/icons/staking_icon.SVG" alt="home" width="45"> </a>

       <a data-toggle="tab" href="#menu_info_sock" style=" margin-left: 15px;">  <img  id="image-service" src="images/icons/config_icon.SVG" alt="home" width="45"> </a>
       
       
</ul>
 


 <style>
  /* Estilos para los caracteres @ y # */
span.atSymbol {
    color: blue; /* Color azul para @ */
}

span.hashtag {
    color: red; /* Color rojo para # */
}

/* Estilos para la imagen o el video */
#mediaContent img,
#mediaContent video {
    max-width: 100%; /* Ajuste para el ancho */
    height: auto;
}
</style>






  <div class="tab-content" style="border: 2px solid lime; border-radius: 20px; background:white;">
    



    <div id="home" class="tab-pane fade in active" >
         <br>
                   

         <div id="publications-container"></div>
          
         <div class="user-following-publication-container"  >
         </div> 
    

    </div>
<!--#################################################-->    





    <div id="menu1" class="tab-pane fade">
   <!--****************************************************-->
   <!--****************************************************-->
                 
                
          <div class="container-fluid" style="display: flex; justify-content: space-between; margin-top: 10px; margin-bottom: 10px">
               
                

              <a class="underlineHover" onclick="restore_button_update()" href="#" data-toggle="modal" data-target="#myModalprofile">
                <span class="glyphicon glyphicon-user" style="color: black; font-size: 24px; vertical-align: middle;"></span>
              </a>

                <a class="underlineHover" onclick="loadProfile()" style="display: inline-block;"><span class="glyphicon glyphicon-pencil" style="color: black; font-size: 24px;"></a>

               <a class="underlineHover" onclick="goToExplain()" style="display: inline-block;"><span class="glyphicon glyphicon-trash" style="color: black; font-size: 24px;"></a>   
                      
           </div>

           <div id="nft-username-profile"></div>
            
              
             <center><h3>Follower and following username</h3></center>
              <br>
              <br>

       
   </div>  




    <div id="menu2" class="tab-pane fade">    
       <!-- <div class="user-publication-container">
             <a href="games/asteroides/asteroides.html" target="_blank">Jugar Asteroides</a>            
        </div> -->

         <br>
          
             <center><h3>You Publications</h3></center>
              <br>
               <br>

        
         
    </div>

  


    


    <!--/////////////////////////////////////////////////////////////-->
    <!--/////////////////////////////////////////////////////////////-->
    <div id="menu_mensaje" class="tab-pane fade">
      
      <div class="container-fluid"> 
          <h4><div id="nft-username-list-direct-message"></div></h4>   
          <br>
           
             <center><h3>Direct Messages</h3></center>
              <br>
               <br>
      </div>
    </div>
    <!--/////////////////////////////////////////////////////////////-->
     <!--/////////////////////////////////////////////////////////////-->
    <!--/////////////////////////////////////////////////////////////-->
    <div id="menu_play" class="tab-pane fade">
      
      <div class="container-fluid"> 
          <h4><div id="nft-username-list-direct-message"></div></h4>   
          
             <!-- Botón opcional para 2mcargar el juego -->
         
         <div style="display: flex; gap: 10px; justify-content: center; align-items: center; margin: 20px;">
    <!-- Botón 1 -->
    <button onclick="loadGame()" style="display: flex; align-items: center;  background-color: white; color: white; border: none; border-radius: 10px; cursor: pointer;">
        <img src="games/cartaMayor/images/majorcart.SVG" alt="Icono" style="width: 120px;">
        
    </button>
    <!-- Botón 2 -->
    <button onclick="loadGame_sockWar()" style="display: flex; align-items: center;  font-size: 16px; background-color: white; color: white; border: none; border-radius: 10px; cursor: pointer;">
        <img src="games/sockWar/images/sockwar.SVG" alt="Icono" style="width: 120px;">
        
    </button>
</div>

        
          <div id="gameContainer"></div>        
              
             
      </div>
    </div>
  
    <!--/////////////////////////////////////////////////////////////-->
 <!--/////////////////////////////////////////////////////////////-->
    <!--/////////////////////////////////////////////////////////////-->
  <!--   <div id="menu_play_to_earn" class="tab-pane fade">
      
      <div class="container-fluid"> 
          <h4><div id="nft-username-list-direct-message"></div></h4>   
          <br>
           
             <center><h3>Game play to earn and Bets</h3></center>
              <br>
               <br>
      </div>
    </div>
-->

<!--/////////////////////////////////////////////////////////////-->
    <!--/////////////////////////////////////////////////////////////-->
    <div id="menu_transfer" class="tab-pane fade">
          
          <br>
          <center><h3><p>Swap and transfer token</p></h3></center> 
          
          <br>
          <br>
           
    
    </div>     
<!--/////////////////////////////////////////////////////////////-->
    <!--/////////////////////////////////////////////////////////////-->

    <div id="menu_staking" class="tab-pane fade" >
       
         <div class="container-fluid" style = "width:80%; align-items: center;">
                       </div>

          <br>   
              <center>  <h3>Staking Pool</h3> </center>                   
                  <br>
                 
                 <br>  
          
    </div> 

    
          
                   
   
    <!--/////////////////////////////////////////////////////////////-->
    <!--/////////////////////////////////////////////////////////////-->

 <div id="menu_info_sock" class="tab-pane fade">      
     
                <br>
                <center><h3><p>Info Sock Puppet</p></h3></center>
                <br>       
                <div id="info-sock"></div>  
                          
 </div>
 <!--/////////////////////////////////////////////////////////////-->
 <!--/////////////////////////////////////////////////////////////-->







    

  </div>

                    
  
     





                </div>
<br>

            
<style>
.col-sm-4 {
    position: -webkit-sticky;
    position: sticky;
    top: 0;
    height: 100vh; /* Establece la altura máxima del contenido pegajoso */
    overflow-y: auto; /* Agrega un desplazamiento vertical si es necesario */
    /* Otros estilos para la columna sm-3 */
}

</style>



            <div class="col-sm-4">
               
                <div class="well" style="border: 2px solid lime; background: black; border-radius: 20px;">

                     
                          <div class="input-group">
                            <div id ="NFTUsernames-count">NFTUsernames: </div>
                            <br>
                            <input type="text" id="text-address-wallet" class="form-control" placeholder="Search 0x.. or NftUsername" style="border: 2px solid black; border-radius: 20px; width: 100%; height: 40px; margin-right: 10px;">
                            <div class="input-group-btn">
                              <button id="btn-find-nft" class="btn btn-default"  onclick="findNftWallet('user')" style="background-color: black; color: white; border: 2px solid lime; border-radius: 20px; height: 40px;">
                                <span class="glyphicon glyphicon-search"></span>
                              </button>                             
                            </div>
                          </div> 
                           <br>

                           <button id="btn-find-followin"  onclick="findNftWallet('following')"style="background-color: black; color: white; border: 2px solid lime; border-radius: 20px; height: 40px;">Siguiendo</button> 

                           <button id="btn-find-followers"  onclick="findNftWallet('followers')"style="background-color: black; color: white; border: 2px solid lime; border-radius: 20px; height: 40px;">Seguidores

                       

                           <!--<button id="btn-find-nft-for-you" onclick="findNftWallet('foryou')" style="background-color: black; color: white; border: 2px solid lime; border-radius: 20px; height: 40px;">
                                </span>For you. 
                              </button>--> 
 <!--
                              <button id="btn-find-nft-for-you-rand" onclick="findNftWallet('foryourand')" style="background-color: black; color: white; border: 2px solid lime; border-radius: 20px; height: 40px;">
                               Rand. 
                              </button> 
-->
 <!--
                              <button id="btn-find-nft-for-you-last" onclick="findNftWallet('foryoulast')"  style="background-color: black; color: white; border: 2px solid lime; border-radius: 20px; height: 40px;">
                                Last. 
                              </button> 
                              
 -->                             
          

            


                                                    

                        
                       
                           
                           <br>
                          <h4><div id="nft-username-list" style="border: 2px solid white"></div></h4>

                           <h4><div id="nft-username-list-for-you"></div></h4>
                                                                 
           
                    
                </div>     

                   
              
                  <div class="well" style="border: 2px solid lime;  border-radius: 20px;">

                    <!--<button class="boton-conectar"  onclick="openBuyNftModal(`ernesto`)" style="display: inline-block; margin-left: 10px;">load image</button>   
                   -->
                    <div id="success-message"></div>
                           <div id="error-message"></div>  
                          
                  </div>

                                             
                                                 
                            
                                         
                </div>               



            </div>

            <div class="col-sm-1"> 
            </div>

            
        </div>
    </div>





<!-- ############## ventana emergente Publicaciones ###########################-->
<!-- #################################################################################-->
<!-- #####################################################################-->
<!-- #####################################################################-->
<!-- #####################################################################-->
<!-- #####################################################################-->

<div class="container">
  
<!-- Modal -->
<div class="modal fade" id="myModal_publication" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content -->
        <div class="modal-content" style="background: linear-gradient(180deg, lime, black);">
            
            <div class="modal-body" style="display: flex; align-items: flex-start; gap: 10px;">
              <!--   <div id="publication-NFT_image-container" style="width: 80px; height: 80px; "></div>-->
                <div id="publication-post-container" style="flex: 1; padding: 10px; border-radius: 10px;"></div>                  
            </div>      
            
        </div>      
            

            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
  


<!-- #####################################################################-->
<!-- #####################################################################-->
<!-- #####################################################################-->
<!-- #####################################################################-->
<!-- #####################################################################-->
<!-- #####################################################################-->

<!-- ############## ventana emergente RESPONSES ###########################-->
<!-- #################################################################################-->
<!-- #####################################################################-->
<!-- #####################################################################-->
<!-- #####################################################################-->
<!-- #####################################################################-->
<style>
.spinner {
  border: 5px solid rgba(0, 0, 0, 0.1);
  border-left: 5px solid #FFD700; /* Amarillo */
  border-radius: 50%;
  width: 50px;
  height: 50px;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
</style>


<div class="container">
  <!-- Modal -->
  <div class="modal fade" id="myModal-responses" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content" style="background: linear-gradient(180deg, lime, black);">
        <div class="modal-header">
          <div class="profile-form">
            

          </div>
        </div>
        <div class="modal-body">
         
          <center>

            <div id= "responses" > </div>

                       
          </center>


          
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
        </div>
      </div>
    </div>
  </div>  
</div>
<!-- #####################################################################-->
<!-- #####################################################################-->
<!-- #####################################################################-->
<!-- #####################################################################-->
<!-- #####################################################################-->
<!-- #####################################################################-->

<!-- ############## ventana emergente Mintear NFTusernameCAW ###########################-->
<!-- #################################################################################-->
<!-- #####################################################################-->
<!-- #####################################################################-->
<!-- #####################################################################-->
<!-- #####################################################################-->
<style>
.spinner {
  border: 5px solid rgba(0, 0, 0, 0.1);
  border-left: 5px solid #FFD700; /* Amarillo */
  border-radius: 50%;
  width: 50px;
  height: 50px;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
</style>


<div class="container">
  <!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content" style="background: linear-gradient(180deg, lime, black);">
        <div class="modal-header">
           <button type="button" class="close" data-dismiss="modal">&times;</button>
          <div class="profile-form">
            <center>
              <h3>NFTUsername</h3>
            </center>
          </div>
        </div>
        <div class="modal-body">


       

     <center>

          <div id="loadingAnimation-mint" style="display: none;">
            <div class="spinner"></div>              
          </div>

          <!--*******************************************************   -->


    <style>
        #image-container {
            position: relative;
            width: 250px; /* Ajusta según sea necesario */
            height: 250px; /* Ajusta según sea necesario */
            border: 8px solid white;
            /*border: 1px solid #ccc; /* Opcional, solo para visualizar el contenedor */
        }
        .layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
    </style>
 
    <div class="img-circle" id="image-container"></div>
    <p id="codeimageHexa">    </p>
    <br>
    
 

  <div style="display: flex; align-items: center; justify-content: flex-start; gap: 0;">
    <p style = "font-size: 18px; color: white;" ><i>1- Select image for you NFTUsername</i></p>
    <button onclick="loadImages()" style="background-color: black; color: white; border: 2px solid lime; border-radius: 20px; height: 40px; margin-left: 30px">Next > </button>
 </div>      

<!-- *******************************************************-->

            <h3><font color="white"><p id="Minted_username"></p></font></h3>
            <h4><font color="orange"><p id="Error_Minted_username"></p></font></h4>
      
            <input type="text" id="text-mintear-nft" placeholder=" 2- Enter a username " required required style="border: 2px solid black; border-radius: 20px; width: 75%; margin-bottom: 10px; height: 40px;  font-size: 24px;"/> 
            <br>           
            <br>

            <button id="btn-verify-nft" style="background-color: black; color: white; border: 2px solid lime; border-radius: 20px; height: 40px;">check username before</button>

            <button id="btn-mintear-nft" style="background-color: black; color: white; border: 2px solid lime; border-radius: 20px; height: 40px; display:none;">Mint NFT Username</button>
          

          <div style="display: flex; align-items: center; justify-content: flex-start; gap: 0; color: lime;">
             <h4 style="margin: 0;">POL required is :</h4>
             <p id="mount-minteo" style="margin: 0;"></p>
          </div>

          </center>




          
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
        </div>
      </div>
    </div>
  </div>  
</div>
<!-- #####################################################################-->
<!-- #####################################################################-->
<!-- #####################################################################-->
<!-- #####################################################################-->
<!-- #####################################################################-->
<!-- #####################################################################-->

<!-- ############## ventana emergente crear un perfil ###########################-->
<!-- #################################################################################-->
<div class="container" > 
  <!-- Modal -->
  <div class="modal fade" id="myModalprofile" role="dialog">
    <div class="modal-dialog">    
      <!-- Modal content-->
      <div class="modal-content" style="background: linear-gradient(180deg, lime, black);">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
                     
        <div class="modal-body">    
        
         <div class="profile-form">
           <center> <h2><font color="black ">User Profile</h2></font> </center>     

           <center>
    <div style="width: 80%;">
        <input type="text" id="nombre" placeholder=" Nombre" required style="border: 2px solid black; border-radius: 20px; width: 100%; margin-bottom: 10px; height: 40px;">                      
        <textarea id="bio" placeholder=" Biografía" required style="border: 2px solid black; border-radius: 20px; width: 100%; margin-bottom: 10px; height: 120px;"></textarea>
        <input type="text" id="ubicacion" placeholder=" Ubicación" style="border: 2px solid black; border-radius: 20px; width: 100%; margin-bottom: 10px; height: 40px;">
        <input type="text" id="pagina-web" placeholder=" Página Web" style="border: 2px solid black; border-radius: 20px; width: 100%; margin-bottom: 10px; height: 40px;">
        <input type="text" id="foto-perfil" placeholder=" Link to profile picture" style="border: 2px solid black; border-radius: 20px; width: 100%; margin-bottom: 10px; height: 40px;">
        <input type="text" id="foto-portada" placeholder=" Link to cover picture" style="border: 2px solid black; border-radius: 20px; width: 100%; margin-bottom: 10px; height: 40px;">
    </div>
</center>
             
               <br>  

 <center><div style="display: flex; width: 80%;">
    <select id="selector_key1" class="form-control" placeholder="select key" style="border: 2px solid black; border-radius: 20px;"></select>
    <select id="selector_key2" class="form-control" placeholder="select key" style="border: 2px solid black; border-radius: 20px;"></select>
    <select id="selector_key3" class="form-control" placeholder="select key" style="border: 2px solid black; border-radius: 20px;"></select>    
</div></center>

<center> <div style="display: flex; width: 80%;">
       
</div></center>

<br>


<center>
       
       <div id="loadingAnimation-profile" style="display: none;">
              <div class="spinner"></div>               
       </div>

   </center> 



               <br> 
          <center>      
              
              <button id="btn-create-profile" onclick="create_NFTUsername_profile(0)"style="background-color: black; color: white; border: 2px solid lime; border-radius: 20px; height: 40px;"> Guardar Perfil </button>


          </center> 

       </div>

        </div>
       
                      
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
        </div>
      </div>      
    </div>
  </div>  
</div>

<!-- ############## ventana emergente QR recibir tokesn ###########################-->
<!-- #################################################################################-->
<div class="container"> 
  <!-- Modal -->
 <!-- Modal -->
<div class="modal fade" id="myModalQR" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->
    <div class="modal-content" style="background: linear-gradient(180deg, lime, black);">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <center><h5><a href="/pagina_principal/0/"><font color="black"> My Public Address   </a></font></h5></center>
         <center><div id="addres-wallet-QR"></div></center>

       
      </div>
      <!--<div class="modal-body">       
      </div>-->
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>
</div>
<!-- #####################################################################-->
<!-- #####################################################################-->


<!-- ############## ventana emergente enviar tokesn ###########################-->
<!-- #################################################################################-->
<div class="container"> 
  <!-- Modal -->
 <!-- Modal -->
<div class="modal fade" id="myModalEnviarTokens" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->
    <div class="modal-content" style="background: linear-gradient(180deg, lime, black);">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <center><h3><p>Enviar</p></h3></center>

            <center> 
            <div id="loadingAnimation-sendSocks" style="display: none;">
              <div class="spinner"></div>               
            </div>

             <div id="loadingAnimation-sendPol" style="display: none;">
              <div class="spinner"></div>               
            </div>
            </center>
             
             <center><div id="modal-enviar-tokens"></div></center>

            

             

       
      </div>
      <!--<div class="modal-body">       
      </div>-->
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>
</div>
<!-- #####################################################################-->
<!-- #####################################################################-->




<!-- Modal para Compra de NFT -->
<!-- Modal para Compra de NFT -->
<div class="container"> 
  <div class="modal fade" id="buyNftModal" role="dialog">
    <div class="modal-dialog">
      <!-- Contenido del modal -->
      <div class="modal-content" style="background: linear-gradient(180deg, lime, black);">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <center><h5><font color="black">Buy NFT Username</font></h5></center>
        </div>
        <div class="modal-body">
          <center>
            <h6><font color="black">Buy  NFTUsername :</font></h6>           
                       
            <div id="info-sock-to-buy"></div>
                    
          </center>
        </div>
        <div class="modal-footer">

         
          <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
        </div>
      </div>
    </div>
  </div>
</div>



<!-- Modal para ver el perfil de un NFTUsername -->

<div class="container"> 
  <div class="modal fade" id="UsernameProfileModal" role="dialog">
    <div class="modal-dialog">
      <!-- Contenido del modal -->
      <div class="modal-content" style="background: linear-gradient(180deg, lime, black);">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
         
        </div>
        <div class="modal-body">
          <center>                                  
               
               <div id="modal_nft-username-profile"></div>
                   
          </center>
        </div>
        <div class="modal-footer">

         
          <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
        </div>
      </div>
    </div>
  </div>
</div>




<!-- Modal predefinido en HTML -->
<div class="modal fade" id="sellNFTModal" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalLabel">Vender NFT</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <!-- Aquí va el contenido dinámico -->
        <p>Precio: <span id="nftPrice"></span></p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
        
      </div>
    </div>
  </div>
</div>







<!-- ############## ventana emergente mensajes directos ###########################-->
<!-- #################################################################################-->


<style>
    #conversation {
      border: 1px solid #ccc;
      padding: 10px;
      height: 300px;
      overflow-y: scroll;
    }

    #messageInput {
      margin-top: 10px;
    }
  </style>




<div class="container"> 
  <!-- Modal -->
 <!-- Modal -->
<div class="modal fade" id="myModal-msg-direct" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->

    <div class="modal-content" style="background: linear-gradient(180deg, lime, black);">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      

<style>
 
.left-section {
    text-align: left;
} 
.right-section {
    text-align: right;
} 
</style>


<center>
 <div class="container-fluid">


    <div class="left-section" style="display:inline-block; ">
        <img id="profile-photo-sender" src="" width="60" class="img-circle" style="border: 4px solid white;">
        <div id="NFTsender-direct-message"></div>
    </div>

    <div class="right-section" style="display:inline-block; margin-left: 60px;">
        <img id="profile-photo-reciever" src="" width="60" class="img-circle" style="border: 4px solid white;">
        <div id="NFTreceiver-direct-message"></div>
    </div>
</div>

</center>

 
<br>
  <div class="container-fluid">
 
 <center>
  
<!--
  <a href="#"  data-toggle="collapse" data-target="#demo2"style="display:inline-block; margin-left: 0px;"><font color="black">ETH <span class="glyphicon glyphicon-arrow-right"></span></font></a>

  <div style="display:inline-block; margin-left: 50px;" > </div>
  <div style="display:inline-block; margin-left: 50px;" > </div>
    <div style="display:inline-block; margin-left: 50px;" > </div>
  <div style="display:inline-block; margin-left: 50px;" > </div>
  <div style="display:inline-block; margin-left: 50px;" > </div>
 
  
  <a href="#"  data-toggle="collapse" data-target="#demo3" style="display:inline-block; margin-left: 30px;"><font color="black">CAW <span class="glyphicon glyphicon-arrow-right"></span></font></a>
  


  <div id="demo2" class="collapse" >
                          


                          <div class="input-group" style="margin-top: 10px; margin-bottom: 10px; width: 90%;">
                            <input type="text" id="text-mount-ETH-send" class="form-control" placeholder="ETH mount to send" style="border: 2px solid black; border-radius: 20px; width: 80%; height: 40px; ">
                           
                            <div class="input-group-btn">
                              <button id="btn-send-ETH" class="btn btn-default"  style="background-color: black; color: white; border: 2px solid gold; border-radius: 20px; height: 40px;">
                                <span class="glyphicon glyphicon-send"></span>
                              </button>                             
                            </div>                          

                           </div> 
                           
                           
  
  <div id="demo3" class="collapse">

                         <div class="input-group" style=" margin-top: 10px; margin-bottom: 10px; width: 90%;">
                            <input type="text" id="text-mount-CAW-send" class="form-control" placeholder="CAW mount to send" style="border: 2px solid black; border-radius: 20px; width: 80%; height: 40px; ">
                            <div class="input-group-btn">
                              <button id="btn-send-CAW" class="btn btn-default" style="background-color: black; color: white; border: 2px solid gold; border-radius: 20px; height: 40px;">
                                <span class="glyphicon glyphicon-send"></span>
                              </button>                             
                            </div>
                          </div> 

  </div>
-->


</center>
</div>


<center><div id="conversation" style="background-color: black; width: 90%; border: 2px solid black; border-radius: 20px; height: 400px;"></div></center>


<center>
 <div class="input-group" style=" margin-top: 10px; margin-bottom: 10px; width: 90%;">

                           <input type="text" id="messageInput" class="form-control" placeholder="Direct Message" style="border: 2px solid black; border-radius: 20px; width: 80%; height: 40px; ">
                            <div class="input-group-btn">
                              <button class="btn btn-default" onclick="enviarMensaje()" style="background-color: black; color: white; border: 2px solid lime; border-radius: 20px; height: 40px;">
                                <span class="glyphicon glyphicon-send"></span>
                              </button>                             
                            </div>
                          </div> 
</center>
   

      <!--<div class="modal-body">       
      </div>-->
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>
</div>
<!-- #####################################################################-->
<!-- #####################################################################-->

        <!-- Puedes agregar más elementos según sea necesario -->
  
   
<script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
<!-- Archivo JavaScript para cargar contenido dinámico del juego carta Mayor-->
    <script src="games/cartaMayor/loadGameCartas.js"></script>
    <script src="games/cartaMayor/scriptCartas.js"></script>
    
    <script src="games/sockWar/loadGameSockWar.js"></script>
    <script src="games/sockWar/scriptSockWar.js"></script>







<script>
    // Definir las palabras clave
     
    const palabras_gustos=['Art and Creativity','Sports and Physical Activities','Entertainment and Media','Culture and Society','Nature and Outdoor Activities','Science and Technology','Gastronomy','Personal Development','Volunteering and Social Causes'];

    const palabras_actitudinales=['Optimism and Positivity','Introspection and Self-Awareness','Ambition and Drive','Empathy and Compassion','Adaptability and Open-Mindedness','Pragmatism and Logic','Creativity and Innovation','Collaboration and Sociability','Resilience and Perseverance'];

    const palabras_coductuales=['Routine and Organization','Risk and Adventure','Helping and Support','Leadership and Authority','Learning and Growth','Conflict and Resolution','Expressiveness and Communication','Resourcefulness and Ingenuity','Collaboration and Teamwork'];

    // Función para llenar los selects
    function llenarSelects() {
      const vector_palabras=[palabras_gustos,palabras_actitudinales,palabras_coductuales];

      for (let i = 1; i <= 3; i++) {
        // Obtener el select actual
        const select = document.getElementById(`selector_key${i}`);
        // Limpiar cualquier opción existente
        select.innerHTML = '';
        // Agregar las opciones
        vector_palabras[i-1].forEach(palabra => {
          const opcion = document.createElement('option');
          opcion.value = palabra;
          opcion.text = palabra;
          select.add(opcion);
        });
      


      }
    

    }

    // Llenar los selects al cargar la página
    llenarSelects();
  </script>


<script> 

/*
const CAW_tokenABI = [
    {"constant": true, "inputs": [], "name": "name", "outputs": [{"name": "", "type": "string"}], "payable": false, "stateMutability": "view", "type": "function"},
    {"constant": true, "inputs": [{"name": "spender", "type": "address"}, {"name": "owner", "type": "address"}], "name": "allowance", "outputs": [{"name": "", "type": "uint256"}], "payable": false, "stateMutability": "view", "type": "function"},
    {"constant": false, "inputs": [{"name": "contractAddress", "type": "address"}], "name": "authorizeContract", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function"},
    {"constant": true, "inputs": [{"name": "owner", "type": "address"}], "name": "balanceOf", "outputs": [{"name": "", "type": "uint256"}], "payable": false, "stateMutability": "view", "type": "function"},
    {"constant": false, "inputs": [{"name": "spender", "type": "address"}, {"name": "subtractedValue", "type": "uint256"}], "name": "decreaseAllowance", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function"},
    {"constant": true, "inputs": [], "name": "decimals", "outputs": [{"name": "", "type": "uint8"}], "payable": false, "stateMutability": "view", "type": "function"},
    {"constant": false, "inputs": [{"name": "spender", "type": "address"}, {"name": "addedValue", "type": "uint256"}], "name": "increaseAllowance", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function"},
    {"constant": true, "inputs": [], "name": "totalSupply", "outputs": [{"name": "", "type": "uint256"}], "payable": false, "stateMutability": "view", "type": "function"},
    {"constant": true, "inputs": [], "name": "symbol", "outputs": [{"name": "", "type": "string"}], "payable": false, "stateMutability": "view", "type": "function"},
    {"constant": false, "inputs": [{"name": "amount", "type": "uint256"}, {"name": "user", "type": "address"}], "name": "burn", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function"},
    {"constant": true, "inputs": [{"name": "spender", "type": "address"}, {"name": "value", "type": "uint256"}], "name": "approve", "outputs": [], "payable": false, "stateMutability": "view", "type": "function"},
    {"constant": false, "inputs": [{"name": "spender", "type": "address"}, {"name": "amount", "type": "uint256"}], "name": "approveCAWTransfer", "outputs": [{"name": "", "type": "bool"}], "payable": false, "stateMutability": "nonpayable", "type": "function"},
    {"constant": false, "inputs": [], "name": "revokeAuthorization", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function"},
    {"constant": true, "inputs": [{"name": "contractAddress", "type": "address"}], "name": "onlyAuthorizedContract", "outputs": [], "payable": false, "stateMutability": "view", "type": "function"}
];*/

const CAW_tokenABI = [{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"spender","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"TokensBurned","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Transfer","type":"event"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"spender","type":"address"}],"name":"allowance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"contractAddress","type":"address"}],"name":"authorizeContract","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"address","name":"user","type":"address"}],"name":"burn","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"decimals","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"subtractedValue","type":"uint256"}],"name":"decreaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"addedValue","type":"uint256"}],"name":"increaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"contractAddress","type":"address"}],"name":"isAuthorizedContract","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"tokenAddress","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"recoverERC20","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"contractAddress","type":"address"}],"name":"revokeAuthorization","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transfer","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transferFrom","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"}];

const tokenContractAddress = '0x8f78976a0fdf8f66ad81bb7d7c9b8d4a695022e3';//Sock -polygon  
let tokenContract;
     



const NFT_ContractABI=[{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"FundsWithdrawn","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"string","name":"username","type":"string"},{"indexed":false,"internalType":"uint256","name":"price","type":"uint256"}],"name":"NFTForSale","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"},{"indexed":true,"internalType":"string","name":"username","type":"string"}],"name":"NFTMinted","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"string","name":"username","type":"string"}],"name":"NFTSaleCancelled","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"string","name":"username","type":"string"},{"indexed":true,"internalType":"address","name":"buyer","type":"address"},{"indexed":false,"internalType":"uint256","name":"price","type":"uint256"}],"name":"NFTSold","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"string","name":"username","type":"string"},{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"}],"name":"NFTTransferred","type":"event"},{"inputs":[{"internalType":"string","name":"username","type":"string"}],"name":"buyNFT","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"string","name":"username","type":"string"}],"name":"cancelNFTSale","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"}],"name":"getEtherBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"username","type":"string"}],"name":"getHashFromUsername","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"walletAddress","type":"address"}],"name":"getMintedUsernames","outputs":[{"internalType":"string[]","name":"","type":"string[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getNFTInfoById","outputs":[{"components":[{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"string","name":"username","type":"string"},{"internalType":"bool","name":"isMinted","type":"bool"},{"internalType":"bool","name":"isForSale","type":"bool"},{"internalType":"uint256","name":"price","type":"uint256"},{"internalType":"bytes32","name":"usernameHash","type":"bytes32"},{"internalType":"bytes32","name":"imagecodeHexa","type":"bytes32"},{"internalType":"uint256","name":"timestamp","type":"uint256"}],"internalType":"struct NFTUsernameContract.NFT","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"username","type":"string"}],"name":"getNFTInfoByUsername","outputs":[{"components":[{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"string","name":"username","type":"string"},{"internalType":"bool","name":"isMinted","type":"bool"},{"internalType":"bool","name":"isForSale","type":"bool"},{"internalType":"uint256","name":"price","type":"uint256"},{"internalType":"bytes32","name":"usernameHash","type":"bytes32"},{"internalType":"bytes32","name":"imagecodeHexa","type":"bytes32"},{"internalType":"uint256","name":"timestamp","type":"uint256"}],"internalType":"struct NFTUsernameContract.NFT","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"nftUsername","type":"string"}],"name":"getNFTOwner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"nftUsername","type":"string"}],"name":"getNFTTokenId","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"nftUsername","type":"string"}],"name":"getNFTTokenTime","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"walletAddress","type":"address"}],"name":"getNFTUsername","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getNftIsForSaleCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getTotalMintedNFTs","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getUsernameByTokenId","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes32","name":"hash","type":"bytes32"}],"name":"getUsernameFromHash","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"startIndex","type":"uint256"},{"internalType":"uint256","name":"endIndex","type":"uint256"}],"name":"getUsernamesInRange","outputs":[{"internalType":"string[]","name":"","type":"string[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"username","type":"string"}],"name":"getimagecodeHexaFromUsername","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"nftUsername","type":"string"}],"name":"isCallerNFTOwner","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"nftUsername","type":"string"}],"name":"isMinted","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"username","type":"string"}],"name":"isNFTForSale","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"nftOwner","type":"address"},{"internalType":"string","name":"nftUsername","type":"string"},{"internalType":"address","name":"caller","type":"address"}],"name":"isNFTOwner","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"username","type":"string"},{"internalType":"bytes32","name":"imagecodeHexa","type":"bytes32"}],"name":"mintNFT","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address payable","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"username","type":"string"},{"internalType":"uint256","name":"price","type":"uint256"}],"name":"sellNFT","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"string","name":"username","type":"string"}],"name":"transferNFT","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"withdraw","outputs":[],"stateMutability":"nonpayable","type":"function"}];
 
const nftContractAddress = '0xac6f27b3b55b96d7f6bfc4b905257bed6758922e';//polygon verificado 
let nftUsernameContract;





const Bet_ContractABI = [{"inputs":[{"internalType":"address","name":"sockTokenAddress","type":"address"},{"internalType":"address","name":"nftContractAddress","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"OwnableInvalidOwner","type":"error"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"OwnableUnauthorizedAccount","type":"error"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"newBetAmount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"newRewardAmount","type":"uint256"}],"name":"BetAndRewardAmountUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"betId","type":"uint256"},{"indexed":true,"internalType":"address","name":"player","type":"address"},{"indexed":false,"internalType":"bytes32","name":"nftUsernameHash","type":"bytes32"},{"indexed":false,"internalType":"uint256","name":"betAmount","type":"uint256"}],"name":"BetCreated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"betId","type":"uint256"},{"indexed":true,"internalType":"address","name":"opponent","type":"address"},{"indexed":false,"internalType":"bytes32","name":"nftUsernameHash","type":"bytes32"}],"name":"BetJoined","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"betId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"result","type":"uint256"}],"name":"BetResolved","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"inputs":[],"name":"betAmount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"betCounter","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"bets","outputs":[{"internalType":"address","name":"player","type":"address"},{"internalType":"bytes32","name":"nftUsernameHash","type":"bytes32"},{"internalType":"bytes","name":"encryptedMove","type":"bytes"},{"internalType":"uint256","name":"betAmount","type":"uint256"},{"internalType":"bool","name":"resolved","type":"bool"},{"internalType":"address","name":"opponent","type":"address"},{"internalType":"uint256","name":"result","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes32","name":"nftUsernameHash","type":"bytes32"},{"internalType":"bytes","name":"encryptedMove","type":"bytes"}],"name":"createBet","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"betId","type":"uint256"}],"name":"getBetHistory","outputs":[{"components":[{"internalType":"address","name":"player","type":"address"},{"internalType":"bytes32","name":"nftUsernameHash","type":"bytes32"},{"internalType":"bytes","name":"encryptedMove","type":"bytes"},{"internalType":"uint256","name":"betAmount","type":"uint256"},{"internalType":"bool","name":"resolved","type":"bool"},{"internalType":"address","name":"opponent","type":"address"},{"internalType":"uint256","name":"result","type":"uint256"}],"internalType":"struct BettingContract.Bet","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getContractBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes32","name":"nftUsernameHash","type":"bytes32"}],"name":"getPlayerBetHistory","outputs":[{"components":[{"internalType":"address","name":"player","type":"address"},{"internalType":"bytes32","name":"nftUsernameHash","type":"bytes32"},{"internalType":"bytes","name":"encryptedMove","type":"bytes"},{"internalType":"uint256","name":"betAmount","type":"uint256"},{"internalType":"bool","name":"resolved","type":"bool"},{"internalType":"address","name":"opponent","type":"address"},{"internalType":"uint256","name":"result","type":"uint256"}],"internalType":"struct BettingContract.Bet[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"hasOpenBet","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"hasOpenBetStatus","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes32","name":"","type":"bytes32"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"playerBets","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"rewardAmount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"newBetAmount","type":"uint256"},{"internalType":"uint256","name":"newRewardAmount","type":"uint256"}],"name":"updateBetAndRewardAmount","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"withdrawTokens","outputs":[],"stateMutability":"nonpayable","type":"function"}];

const betContractAddress = '0x37C306540D620c78f90740810B92b839f2293fF9';//polygon verificado  
let betContract;




const Transfer_ContractABI=[{"constant":false,"inputs":[{"name":"senderNFTUsername","type":"string"},{"name":"receiverNFTUsername","type":"string"},{"name":"userTimestamp","type":"uint256"},{"name":"signatureToUser","type":"bytes32"},{"name":"typeAction","type":"string"}],"name":"actionTransfer","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"nftUsername","type":"string"}],"name":"checkNFTOwnership","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"cawTokenAddress","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"cawContractStaking","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"nftContractAddress","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"nftUsername","type":"string"}],"name":"isNFTMinted","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getNFTUsername","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"cawTokenAddress","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"user","type":"address"}],"name":"getCawBalance","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"}];

const transferContractAddress = '0x9582dacf43aa2bf143ac909faa5a718cbca92333';//polygon





const Profile_ContractABI =[{"inputs":[{"internalType":"address","name":"nftContractAddress","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"OwnableInvalidOwner","type":"error"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"OwnableUnauthorizedAccount","type":"error"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"string","name":"nftUsername","type":"string"},{"indexed":false,"internalType":"string","name":"json","type":"string"},{"indexed":false,"internalType":"string[3]","name":"tags","type":"string[3]"}],"name":"ProfileCreated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"string","name":"nftUsername","type":"string"}],"name":"ProfileDeleted","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"string","name":"nftUsername","type":"string"},{"indexed":false,"internalType":"string","name":"json","type":"string"},{"indexed":false,"internalType":"string[3]","name":"tags","type":"string[3]"}],"name":"ProfileUpdated","type":"event"},{"inputs":[{"internalType":"string","name":"username","type":"string"},{"internalType":"string","name":"json","type":"string"},{"internalType":"string[3]","name":"tags","type":"string[3]"}],"name":"createProfile","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"username","type":"string"}],"name":"deleteProfile","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"username","type":"string"}],"name":"getProfileByUsername","outputs":[{"components":[{"internalType":"string","name":"nftUsername","type":"string"},{"internalType":"string","name":"json","type":"string"},{"internalType":"string[3]","name":"tags","type":"string[3]"},{"internalType":"uint256","name":"timestamp","type":"uint256"}],"internalType":"struct UserProfileContract.Profile","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getProfileCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"tag","type":"string"},{"internalType":"uint256","name":"limit","type":"uint256"}],"name":"getProfilesByActitudTag","outputs":[{"internalType":"string[]","name":"","type":"string[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"tag","type":"string"},{"internalType":"uint256","name":"limit","type":"uint256"}],"name":"getProfilesByConductaTag","outputs":[{"internalType":"string[]","name":"","type":"string[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"tag","type":"string"},{"internalType":"uint256","name":"limit","type":"uint256"}],"name":"getProfilesByGustoTag","outputs":[{"internalType":"string[]","name":"","type":"string[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"profileCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"username","type":"string"},{"internalType":"string","name":"json","type":"string"},{"internalType":"string[3]","name":"tags","type":"string[3]"}],"name":"updateProfile","outputs":[],"stateMutability":"nonpayable","type":"function"}];





const profileContractAddress = '0x486CbA957Ed26A3AFe31ba00df5Dcc64AF4d3274'; //polygon
let profileContract;


const FollowControl_ContractABI =[{"inputs":[{"internalType":"address","name":"_nftContractAddress","type":"address"},{"internalType":"address","name":"_sockToken","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"newFollowFee","type":"uint256"}],"name":"FollowFeeUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"string","name":"follower","type":"string"},{"indexed":true,"internalType":"string","name":"following","type":"string"},{"indexed":false,"internalType":"uint256","name":"timestamp","type":"uint256"}],"name":"Followed","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"newNFTUsernameContract","type":"address"}],"name":"NFTUsernameContractUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"newStakingContract","type":"address"}],"name":"StakingContractUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"string","name":"follower","type":"string"},{"indexed":true,"internalType":"string","name":"following","type":"string"}],"name":"Unfollowed","type":"event"},{"inputs":[{"internalType":"string","name":"follower","type":"string"},{"internalType":"string","name":"following","type":"string"}],"name":"follow","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"followFee","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"follower","type":"string"},{"internalType":"string","name":"following","type":"string"}],"name":"getFollowStatus","outputs":[{"internalType":"bool","name":"isUserFollowing","type":"bool"},{"internalType":"uint256","name":"followTimestamp","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"follower","type":"string"},{"internalType":"string","name":"following","type":"string"}],"name":"getFollowTimestamp","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"username","type":"string"}],"name":"getFollowerCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"username","type":"string"}],"name":"getFollowersList","outputs":[{"internalType":"string[]","name":"","type":"string[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"username","type":"string"}],"name":"getFollowingCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"username","type":"string"}],"name":"getFollowingList","outputs":[{"internalType":"string[]","name":"","type":"string[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"follower","type":"string"},{"internalType":"string","name":"following","type":"string"}],"name":"isFollowedBy","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"follower","type":"string"},{"internalType":"string","name":"following","type":"string"}],"name":"isFollowing","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"sockToken","outputs":[{"internalType":"contract IERC20","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"stakingContract","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"follower","type":"string"},{"internalType":"string","name":"following","type":"string"}],"name":"unfollow","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_followFee","type":"uint256"}],"name":"updateFollowFee","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_nftContractAddress","type":"address"}],"name":"updateNFTUsernameContract","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_stakingContract","type":"address"}],"name":"updateStakingContract","outputs":[],"stateMutability":"nonpayable","type":"function"}];


const followControlContractAddress = "0xb2792ddb0807e76ffb024055421cf37015bd880e";//polygon follow unfollow contract
let followControlContract;




const Publisher_ContractABI=[{"inputs":[{"internalType":"address","name":"_nftContractAddress","type":"address"},{"internalType":"address","name":"_sockToken","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"newNFTUsernameContract","type":"address"}],"name":"NFTUsernameContractUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":true,"internalType":"string","name":"nftUsername","type":"string"},{"indexed":false,"internalType":"string","name":"content","type":"string"},{"indexed":false,"internalType":"enum PostControl.PublicationType","name":"publicationType","type":"uint8"},{"indexed":false,"internalType":"uint256","name":"parentPublicationId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"timestamp","type":"uint256"}],"name":"PublicationCreated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"publicationId","type":"uint256"},{"indexed":true,"internalType":"string","name":"nftUsername","type":"string"},{"indexed":false,"internalType":"uint256","name":"timestamp","type":"uint256"}],"name":"PublicationDeleted","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"publicationId","type":"uint256"},{"indexed":true,"internalType":"string","name":"nftUsername","type":"string"},{"indexed":false,"internalType":"string","name":"content","type":"string"},{"indexed":false,"internalType":"uint256","name":"timestamp","type":"uint256"}],"name":"PublicationEdited","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"newFollowFee","type":"uint256"}],"name":"PublicationFeeUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"newStakingContract","type":"address"}],"name":"StakingContractUpdated","type":"event"},{"inputs":[{"internalType":"string","name":"nftUsername","type":"string"},{"internalType":"string","name":"content","type":"string"},{"internalType":"string","name":"jsonMetadata","type":"string"},{"internalType":"enum PostControl.PublicationType","name":"publicationType","type":"uint8"},{"internalType":"uint256","name":"parentPublicationId","type":"uint256"},{"internalType":"uint256","name":"threadOrder","type":"uint256"}],"name":"createPublication","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"publicationId","type":"uint256"}],"name":"deletePublication","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"publicationId","type":"uint256"},{"internalType":"string","name":"content","type":"string"},{"internalType":"string","name":"jsonMetadata","type":"string"}],"name":"editPublication","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"nftUsername","type":"string"}],"name":"getMainPostsByNFTUsername","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"parentId","type":"uint256"}],"name":"getMainposts","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"publicationId","type":"uint256"}],"name":"getPublication","outputs":[{"components":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"string","name":"content","type":"string"},{"internalType":"string","name":"jsonMetadata","type":"string"},{"internalType":"string","name":"nftUsername","type":"string"},{"internalType":"enum PostControl.PublicationType","name":"publicationType","type":"uint8"},{"internalType":"uint256","name":"parentPublicationId","type":"uint256"},{"internalType":"uint256","name":"threadOrder","type":"uint256"},{"internalType":"uint256","name":"timestamp","type":"uint256"}],"internalType":"struct PostControl.Publication","name":"","type":"tuple"},{"internalType":"uint256[]","name":"threads","type":"uint256[]"},{"internalType":"uint256[]","name":"responses","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"nftUsername","type":"string"},{"internalType":"uint256","name":"publicationId","type":"uint256"}],"name":"getPublicationByNFTUsername","outputs":[{"components":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"string","name":"content","type":"string"},{"internalType":"string","name":"jsonMetadata","type":"string"},{"internalType":"string","name":"nftUsername","type":"string"},{"internalType":"enum PostControl.PublicationType","name":"publicationType","type":"uint8"},{"internalType":"uint256","name":"parentPublicationId","type":"uint256"},{"internalType":"uint256","name":"threadOrder","type":"uint256"},{"internalType":"uint256","name":"timestamp","type":"uint256"}],"internalType":"struct PostControl.Publication","name":"","type":"tuple"},{"internalType":"uint256[]","name":"threads","type":"uint256[]"},{"internalType":"uint256[]","name":"responses","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"parentId","type":"uint256"}],"name":"getResponses","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"nftUsername","type":"string"}],"name":"getResponsesByNFTUsername","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"parentId","type":"uint256"}],"name":"getThreads","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"nftUsername","type":"string"}],"name":"getThreadsByNFTUsername","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"publicationCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"publicationFee","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"sockToken","outputs":[{"internalType":"contract IERC20","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"stakingContract","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_nftContractAddress","type":"address"}],"name":"updateNFTUsernameContract","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_publicationFee","type":"uint256"}],"name":"updatePublicationFee","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_stakingContract","type":"address"}],"name":"updateStakingContract","outputs":[],"stateMutability":"nonpayable","type":"function"}];


//0x54cdc95d8e45b9bde89556ded5fa38a5856a253c
const publisherContractAddress = '0xf8e01ee332845747920e3896586c7d9eb5147808';//polygon

let publisherContract;




const DirectMessage_ContractABI=[{"constant":false,"inputs":[{"name":"senderNFTHash","type":"bytes32"},{"name":"receiverNFTHash","type":"bytes32"},{"name":"encryptedMessage","type":"bytes"},{"name":"jsonMetadataEncrypted","type":"string"},{"name":"signature","type":"bytes32"}],"name":"sendDirectMessage","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"senderNFTHash","type":"bytes32"},{"name":"receiverNFTHash","type":"bytes32"},{"name":"messageId","type":"uint256"}],"name":"markMessageAsDeleted","outputs":[],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"senderNFTHash","type":"bytes32"},{"name":"receiverNFTHash","type":"bytes32"},{"name":"messageId","type":"uint256"}],"name":"markMessageAsNotDeleted","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"senderNFTHash","type":"bytes32"},{"name":"receiverNFTHash","type":"bytes32"},{"name":"messageId","type":"uint256"}],"name":"undeleteAllSenderMessages","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"senderNFTHash","type":"bytes32"},{"name":"receiverNFTHash","type":"bytes32"},{"name":"messageId","type":"uint256"}],"name":"markMessageAsDeleted","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"senderNFTHash","type":"bytes32"},{"name":"receiverNFTHash","type":"bytes32"}],"name":"getConversation","outputs":[{"name":"","type":"bytes[][]"},{"name":"","type":"bytes[][]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"senderNFTHash","type":"bytes32"},{"name":"receiverNFTHash","type":"bytes32"}],"name":"deleteAllSenderMessages","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"senderNFTHash","type":"bytes32"},{"name":"receiverNFTHash","type":"bytes32"},{"name":"messageId","type":"uint256"}],"name":"markMessageAsNotDeleted","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"senderNFTHash","type":"bytes32"},{"name":"receiverNFTHash","type":"bytes32"}],"name":"deleteAllSenderMessages","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"senderNFTHash","type":"bytes32"},{"name":"receiverNFTHash","type":"bytes32"},{"name":"messageId","type":"uint256"}],"name":"undeleteAllSenderMessages","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"nftUsername","type":"string"}],"name":"checkNFTOwnership","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"nftUsername","type":"string"}],"name":"isNFTMinted","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"walletAddress","type":"address"}],"name":"getNFTUsername","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"signer","type":"address"},{"name":"message","type":"bytes"},{"name":"signature","type":"bytes32"}],"name":"verifySignature","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"pure","type":"function"},{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"name":"senderNFTHash","type":"bytes32"},{"indexed":true,"name":"receiverNFTHash","type":"bytes32"}],"name":"DirectMessageSent","type":"event"}];

  
  
const directMessageContractAddress = '0x721ae299de508da89b4f68e28098ff60fde98065'; //polygon
  
    
      
const StakingPool_ContractABI = [{"constant":true,"inputs":[],"name":"getTotalStaked","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getTotalRewards","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"stakers","outputs":[{"name":"amountStaked","type":"uint256"},{"name":"lastClaimTimestamp","type":"uint256"},{"name":"totalRewardsEarned","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"amount","type":"uint256"}],"name":"stake","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"amount","type":"uint256"}],"name":"unstake","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"claimRewards","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"anonymous":false,"inputs":[{"indexed":true,"name":"staker","type":"address"},{"indexed":false,"name":"amount","type":"uint256"}],"name":"Staked","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"staker","type":"address"},{"indexed":false,"name":"amount","type":"uint256"}],"name":"Unstaked","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"staker","type":"address"},{"indexed":false,"name":"amount","type":"uint256"}],"name":"RewardsClaimed","type":"event"},{"constant":true,"inputs":[{"name":"stakerAddress","type":"address"}],"name":"calculatePendingRewards","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"stakerAddress","type":"address"}],"name":"getStaker","outputs":[{"name":"amountStaked","type":"uint256"},{"name":"lastClaimTimestamp","type":"uint256"},{"name":"totalRewardsEarned","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"}]; 


const stakingPoolContractAddress = '0xC6284bBEA6E993Ccf60add9DB1F7AEC644f9aCEa';    //polygon  


/*
FreeTokens_ContractABI = [{"constant":false,"inputs":[],"name":"conectar","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":false,"inputs":[],"name":"requestTokensCaw","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"constant":false,"inputs":[],"name":"receiveTokensCaw","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"obtenerSaldoEtherContrato","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"obtenerSaldoCawContrato","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_receiver","type":"address payable"}],"name":"sendEtherToAddress","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"}];


const freeTokensContractAddress = '0xa0b89d894939e5810849e602a3e3f3e75931b07e';//polygon  

*/


/*
//setting para la red MATIC sin usar metamask

// Setup: npm install alchemy-sdk
// Github: https://github.com/alchemyplatform/alchemy-sdk-js
import { Network, Alchemy } from "alchemy-sdk";

// Optional config object, but defaults to demo api-key and eth-mainnet.
const settings = {
  apiKey: "ur1NT06b5xJJs619w8MiC1jDWE2RXEH9", // Replace with your Alchemy API Key.
  network: Network.MATIC_MAINNET, // Replace with your network.
};
const alchemy = new Alchemy(settings);

alchemy.core.getBlock(15221026).then(console.log);
*/

let globalWalletKey = "";
let provider;
let wallet;
//let web3;  // Definir web3 como global si necesitas usarlo en varias funciones
let web3;  

async function iniciarApp() {
    try {
        // Primero, intenta conectar usando la wallet propia si hay una clave privada almacenada
        const privateKey = localStorage.getItem("privateKey");
        console.log("privateKey" + privateKey ); 

        if (localStorage.getItem("privateKey")) {
            console.log("Conectando usando la wallet propia...");
            conectarWalletPropia(); // Conexión con wallet propia
        } 
           
        // Luego, si no hay wallet propia, intenta conectar con MetaMask
        else if (typeof window.ethereum !== 'undefined' && window.ethereum.isMetaMask ) {
            console.log("MetaMask detectado. Intentando conectar...");
            await conectarMetaMask(); // Conexión con MetaMask
        } 
        // Si no hay MetaMask ni una clave privada, muestra un error
        else {
            console.error("No se detectó MetaMask ni una clave privada. Por favor, configura tu wallet.");
            return;
        }

        // Ejecutar lógica común después de conectarse
        await inicializarUI();
    } catch (error) {
        console.error("Error en iniciarApp:", error);
    }
}
// Conectar con MetaMask
async function conectarMetaMask() {
    try {
        // Solicitar acceso a la cuenta del usuario
        await window.ethereum.request({ method: "eth_requestAccounts" });
        // Inicializar web3 con MetaMask
         // Inicializar web3 si no está definido
        if (!web3) {
            web3 = new Web3(window.ethereum);
        }
        
        // Obtener las cuentas conectadas
        const accounts = await web3.eth.getAccounts();
        globalWalletKey = accounts[0]; // Guardar la dirección de la wallet
        // Inicializar ethers.js provider y tokenContract
        provider = new ethers.providers.Web3Provider(window.ethereum);
        console.log("Conectado con MetaMask:", globalWalletKey);

        tokenContract = new web3.eth.Contract(CAW_tokenABI, tokenContractAddress);
        nftUsernameContract= new web3.eth.Contract(NFT_ContractABI, nftContractAddress);

        freeTokensContract= new web3.eth.Contract(FreeTokens_ContractABI, freeTokensContractAddress);

        betContract= new web3.eth.Contract(Bet_ContractABI, betContractAddress);
        profileContract = new web3.eth.Contract(Profile_ContractABI, profileContractAddress);
        followControlContract = new web3.eth.Contract(FollowControl_ContractABI, followControlContractAddress);
        
        publisherContract= new web3.eth.Contract(Publisher_ContractABI, publisherContractAddress);

    } catch (error) {
        console.error("Error al conectar con MetaMask:", error);
    }
}

// Conectar usando tu wallet propia
function conectarWalletPropia() {
    const privateKey = localStorage.getItem("privateKey");
    if (!privateKey) {
        console.error("No se encontró una clave privada almacenada.");
        return;
    }

    const alchemyUrl = "https://polygon-mainnet.g.alchemy.com/v2/8gJweGU1u8NB60FICShTvPFy3oUu_zsA";
    provider = new ethers.providers.JsonRpcProvider(alchemyUrl);

    wallet = new ethers.Wallet(privateKey, provider);
    globalWalletKey = wallet.address;

    // Configurar el proveedor general (puede ser para Alchemy o cualquier otro nodo)
    
    const signer = new ethers.Wallet(privateKey, provider);
    
    tokenContract = new ethers.Contract(tokenContractAddress, CAW_tokenABI, signer);
    nftUsernameContract = new ethers.Contract(nftContractAddress, NFT_ContractABI, signer);
    freeTokensContract= new ethers.Contract(freeTokensContractAddress, FreeTokens_ContractABI, signer );

    betContract= new ethers.Contract(betContractAddress, Bet_ContractABI, signer); 
    profileContract = new ethers.Contract(profileContractAddress, Profile_ContractABI,  signer); 

    followControlContract = new ethers.Contract(followControlContractAddress, FollowControl_ContractABI, signer);

    publisherContract = new ethers.Contract(publisherContractAddress, Publisher_ContractABI, signer);
          
    console.log("Conectado usando wallet propia:", globalWalletKey);
}



async function logout() {

    localStorage.removeItem("privateKey"); // Elimina la clave privada encriptada almacenada
    globalWalletKey = null; // Limpia la variable global de la dirección
    provider = null; // Limpia el proveedor    
    wallet= null;
    //let web3;  // Definir web3 como global si necesitas usarlo en varias funciones
    web3= null;
    alert("Sesión cerrada !!!");    
    // Redirige o recarga la página
    window.location.href = 'index.html';
}

// Inicializar la interfaz de usuario
async function inicializarUI() {
    // Mostrar dirección en la interfaz
    const start = globalWalletKey.slice(0, 6);
    const end = globalWalletKey.slice(-4);
    document.getElementById("addres-wallet").innerText = `${start}...${end}`;
    document.getElementById("addres-wallet").style.color = "white";

    // Obtener y mostrar saldos
    await obtenerSaldo_POL();
    await obtenerSaldo_SOCK();
    await getmintedNFT();
    
    await get_NFTUsername_profile();
    
    await get_publication(2);

    // Registrar eventos de botones
    document.getElementById("btn-mintear-nft").addEventListener("click", mintearNFT);
    document.getElementById("btn-verify-nft").addEventListener("click", verifymintearNFT);
}

// Iniciar la aplicación al cargar la página

document.addEventListener('DOMContentLoaded', (event) => {
    iniciarApp();
});



async function initializeTransactionContext() {
    try {
        let contractFREETOKENS; 
        //let signer, provider, myAddress, accounts;

        // Verificar si MetaMask está disponible
        if (typeof window.ethereum !== 'undefined') {
            // Si MetaMask está disponible
            console.log('MetaMask detectado');
           
            // Definir los contratos con web3.js (MetaMask)
            contractFREETOKENS = new web3.eth.Contract(FreeTokens_ContractABI, freeTokensContractAddress);
            
        } else {
            // Si MetaMask no está disponible, usar ethers.js con un proveedor y signer
            console.log('Proveedor personalizado detectado');
            
            // Definir los contratos con ethers.js
            contractFREETOKENS = new ethers.Contract(freeTokensContractAddress, FreeTokens_ContractABI, signer);
        }

        // Retornar los valores para ser utilizados en otras funciones
        return {
            contractFREETOKENS,
        };


    } catch (error) {
        console.error('Error al inicializar el contexto de la transacción:', error);
        throw new Error('No se pudo inicializar el contexto de la transacción: ' + error.message);
    }
}



      
async function obtenerSaldo_SOCK() {

    let accountBalance;
    if (tokenContract.methods) {
        console.log("Con MetaMask obtenerSaldo_SOCK().");
        // Usando web3.js
        accountBalance = await tokenContract.methods.balanceOf(globalWalletKey).call();
        console.log("accountBalance SOCK()M." + accountBalance);    
    } else {
        // Usando ethers.js
        console.log("Con SockWallet obtenerSaldo_SOCK().");        
        accountBalance = await tokenContract.balanceOf(globalWalletKey);
        console.log("accountBalance SOCK()." + accountBalance);    

    }

   // Convertir el saldo a una cadena
   const balanceString = accountBalance.toString();
   // Obtener los primeros dígitos (de 0 a longitud - 18)
   const truncatedBalance = balanceString.slice(0, -18);
   // Mostrar el saldo en la página web
   const saldoElement = document.getElementById('saldo_CAW');
   saldoElement.innerText = truncatedBalance;
   saldoElement.style.color = 'lime';

   console.log("Saldo Sock SOCK()." + truncatedBalance);    
   return truncatedBalance;
}  


// Función para obtener el saldo del token
async function obtenerSaldo_POL() {


   let balanceEther;
   if (tokenContract.methods) {
       console.log("Con MetaMask obtenerSaldo_POL().");
       // Obtener el saldo en Wei (la unidad más pequeña de Ethereum)
       const balanceWei = await web3.eth.getBalance(globalWalletKey);       
       balanceEther = web3.utils.fromWei(balanceWei, 'ether');       
       
    
   } else {
        console.log("Con SockWallet obtenerSaldo_POL().");
       // Obtener el saldo de MATIC
        const balanceWei = await provider.getBalance(globalWalletKey);
        balanceEther = ethers.utils.formatEther(balanceWei);
   }

   const truncatedBalanceEther = parseFloat(balanceEther).toFixed(2);
   // Mostrar el saldo en la página web
   const saldoElementETH = document.getElementById('saldo_ETH');
   saldoElementETH.innerText = truncatedBalanceEther;
   saldoElementETH.style.color = 'white';

   // Obtener el precio de MATIC en USD desde CoinGecko
   fetch('https://api.coingecko.com/api/v3/simple/price?ids=matic-network&vs_currencies=usd')
       .then(response => response.json())
       .then(data => {
           const maticPriceInUsd = data['matic-network'].usd;
           const balanceInUsd = (parseFloat(balanceEther) * maticPriceInUsd).toFixed(2);
           console.log("Valor en USD:", balanceInUsd);

           // Mostrar el valor en USD
           const saldoElementUSD = document.getElementById('saldo_USD');
           saldoElementUSD.innerText = " $" + balanceInUsd;
           saldoElementUSD.style.color = 'white';
       })
       .catch(error => console.error("Error al obtener el precio de MATIC:", error));

    return truncatedBalanceEther;
           
}

           // Función para aprobar un contrato
async function aprobarContrato() {
            // Obtener la dirección de la cuenta conectada
            const accounts = await web3.eth.getAccounts();
            const myAddress = accounts[0];
            //alert('Conectado con éxito a MetaMask. Dirección de la cuenta: ' + myAddress);

            const contract = new web3.eth.Contract(CAW_tokenABI, tokenContractAddress);

            try {
              //await contract.methods.authorizeContract(nftContractAddress).send({ from: myAddress });
  await contract.methods.authorizeContract(nftContractAddress).send({from: myAddress, gas: 200000, gasPrice: web3.utils.toWei('50', 'gwei') });

              //alert('Contrato aprobado exitosamente:');
              console.log('Contrato aprobado exitosamente.');
            } catch (error) {
              //alert('Error al aprobar el contrato');
              console.error('Error al aprobar el contrato:', error);
            }
           
          }



// Función para mintear un NFT
async function mintearNFT() {

            const loadingAnimation = document.getElementById('loadingAnimation-mint');
            loadingAnimation.style.display = 'block'; // Muestra la animación al ejecutar la función
           
            // Mintear el NFT
            const nftusername = document.getElementById('text-mintear-nft').value;
            const codeimageHexa = document.getElementById("codeimageHexa").textContent;
            const maticrequired = document.getElementById("mount-minteo").textContent;
            
             //alert('Hexa: ' + codeimageHexa);
            
            try {              
             
              
        let maticAmount;
        if (nftUsernameContract.methods) {
              console.log("Con MetaMask");
              maticAmount = web3.utils.toWei(maticrequired, 'ether'); 

                // Ejecutar la función mintNFT
              await nftUsernameContract.methods.mintNFT(nftusername, codeimageHexa).send({
                  from: globalWalletKey,
                  gas: 800000,
                  gasPrice: web3.utils.toWei('60', 'gwei'),
                  value: maticAmount // Especificar el valor de 10 MATIC
              });
                // Lógica específica para contratos instanciados con web3.js
        } else {
                console.log("Con SockWallet.");
              
                maticAmount = ethers.utils.parseEther(maticrequired); //
                const tx = await nftUsernameContract.mintNFT(nftusername, codeimageHexa, {
                  gasLimit: 800000,
                  gasPrice: ethers.utils.parseUnits('60', 'gwei'), // Gas price en gwei
                  value: maticAmount // Especificar el valor en Wei
                  });

                  console.log("Transacción enviada:", tx.hash);

                  // Esperar confirmación
                  const receipt = await tx.wait();
                  console.log("Transacción confirmada:", receipt);
                  alert('Transaction ok :)');
               // Lógica específica para contratos instanciados con ethers.js
        }




             
              
              //alert('NFT Minteado exitosamente:');
              loadingAnimation.style.display = 'none'; // Oculta la animación
              $('#myModal').modal('hide'); 

              await get_NFTUsername_profile();
              info_profile_sock();

                // Mostrar mensaje de éxito
              showSuccess('NFT minteado correctamente.');
            } catch (error) {

                  loadingAnimation.style.display = 'none'; // Oculta la animación
                 
                  if (error.message.includes("Invalid username")) {
                    showSuccess('Invalid username.');
                  }else if (error.message.includes("Invalid username")){
                    showSuccess('Invalid username.'); 
                  }else if (error.message.includes("Insufficient Sock balance")){
                    showSuccess('Insufficient CAW balance.');
                  }else  {
                    //alert('Error al mintear el NFT');
                    console.error('Error al mintear el NFT:', error);

                  }                  

              
            }

          
          }


          // Función para mintear un NFT
async function getmintedNFT() {
                                         
        try {
             
             let list_username;
             let total_minted_username;

             if (nftUsernameContract.methods) {
                 console.log("Con MetaMask ");
                 // Usando web3.js
                 list_username = await nftUsernameContract.methods.getMintedUsernames(globalWalletKey).call();
                 total_minted_username = await nftUsernameContract.methods.getTotalMintedNFTs().call();

             } else {
                 // Usando ethers.js
                 console.log("Con SockWallet "); 
                 list_username = await nftUsernameContract.getMintedUsernames(globalWalletKey);
                 total_minted_username = await nftUsernameContract.getTotalMintedNFTs();                                    
              }
               
              const total_nft_Username = document.getElementById('NFTUsernames-count');
              total_nft_Username.style.color = 'lime';
              total_nft_Username.innerHTML =`Total NFTUsernames: ${total_minted_username}`; 

                      
              const selector = document.getElementById('selector_NFTs');
              // Limpiar las opciones existentes
              selector.innerHTML = '';
              // Agregar las opciones de NFTs
              for (const nft of list_username) {
                const option = document.createElement('option');
                option.text = nft;
                selector.add(option);
              }


              getImageNFTUsername("NFT_image-container");

              await get_NFTUsername_profile();
               
              info_profile_sock();            
              
              showSuccess('List NFT username OK!.');
 //             console.log('Funcion list NFTs OK.');
               // Mostrar mensaje de éxito
 //             showSuccess('Funcion list NFTs OK.');
        } catch (error) {
              showSuccess('No List NFT username.');
              //alert('Error list NFT');
//              console.error('Error list NFT:', error);
        }
         
}

 // Obtener el selector de NFTs
 const selectorNFTs = document.getElementById('selector_NFTs');
 // Agregar evento 'change' al selector
 selectorNFTs.addEventListener('change', async () => {
            getImageNFTUsername("NFT_image-container");
            info_profile_sock();
            await get_NFTUsername_profile();
 
          });
      

         

         



async function getNFTusernameDirectMessage() {
  // Obtener la dirección de la cuenta conectada
  const accounts = await web3.eth.getAccounts();
  const myAddress = accounts[0];

  const contractNFT = new web3.eth.Contract(NFT_ContractABI, nftContractAddress);
  const contractPROFILE = new web3.eth.Contract(Profile_ContractABI, profileContractAddress);

  const selectorNFTs = document.getElementById('selector_NFTs').value;
  const nft_username_selected = selectorNFTs.replace('@CAW', '');
  
  try {
        //showSuccess('Show mensage amigos: ' + addressUserNfts);
                
        const nftUsernames = await contractPROFILE.methods.getFollowing(nft_username_selected).call();
              
        const nftUsernameList = document.getElementById('nft-username-list-direct-message');
                                                        
        // Limpia el contenido actual del contenedor
        nftUsernameList.innerHTML = "";

        //obtiene el nombre de usuario del selector
       
        //nftUsernames.forEach(function (username) {
    for (const username of nftUsernames) {
    
   
    
try{
    const following = await contractPROFILE.methods.isFollowing(nft_username_selected, username).call();

    const following_following = await contractPROFILE.methods.isFollowing(username, nft_username_selected).call();

    const container = document.createElement("div");


    const profileText = await contractPROFILE.methods.getProfile(username).call();
    const profile = JSON.parse(profileText);
    const img_profile = profile.fotoPerfil;  

    

    if (following) {
               
       if (following_following) {   

            const userButton = document.createElement("span");
            userButton.innerHTML = `<img src="${img_profile}" style="width: 50px; height: 50px; border-radius: 50%; vertical-align: middle; display: inline-block; margin-left: 10px;" >`;
            userButton.classList.add("clickable-button");
            userButton.addEventListener("click", function () {
            //alert("Clickeaste el botón de usuario para " + username);
            });
            userButton.style.marginLeft = "10px"; // Añadir un margen izquierdo para separar los elementos     

            const nameButton = document.createElement("span");
            nameButton.innerHTML = '<span style="font-size: 16px; vertical-align: middle; display: inline-block; margin-left: 10px;"></span>';
            nameButton.textContent = username;
            nameButton.classList.add("clickable-button");
            nameButton.addEventListener("click", function () {
                 
                 readConversation(username);
                 $('#myModal-msg-direct').modal('show');
            
            

            });
            nameButton.style.marginLeft = "10px"; // Añadir un margen izquierdo para separar los elementos


            const msgButton = document.createElement("span");
            msgButton.innerHTML = '<span class="glyphicon glyphicon-envelope" style="font-size: 24px; vertical-align: middle; display: inline-block; margin-left: 10px;" ></span>';
            msgButton.classList.add("clickable-button");
            msgButton.addEventListener("click", function () {
                    //alert("Clickeaste el botón de usuario para " + username);
                    readConversation(username);
                    $('#myModal-msg-direct').modal('show');

            }); 
            msgButton.style.marginLeft = "10px"; // Añadir un margen izquierdo para separar los elementos
            msgButton.style.color = "blue";
        


            
            container.appendChild(userButton);
            container.appendChild(nameButton);
            container.appendChild(msgButton);


       }



    }    else { 
        //userButton.style.color = "black";
    }     


    nftUsernameList.appendChild(container);
} catch (error){

  if (error.message.includes("Profiles do not exist")) {
      const container = document.createElement("div");
      const nameButton = document.createElement("span");
      nameButton.innerHTML = '<span style="font-size: 24px; vertical-align: middle; display: inline-block; margin-left: 10px;"></span>';
      nameButton.textContent = username;
      nameButton.classList.add("clickable-button");
      nameButton.addEventListener("click", function () {
      //alert("Clickeaste el botón de usuario para " + username);
      });
      container.appendChild(nameButton);
      nftUsernameList.appendChild(container);
    } else {
      // Otro manejo de errores si es necesario
      console.error("Errorx:", error);
      
    }
}


// Crear un espacio entre las iteraciones
    const spacer = document.createElement("div");
    spacer.style.height = '20px'; // Ajusta la altura a tu preferencia
    nftUsernameList.appendChild(spacer);


}
   
 

    showSuccess('Show mensage amigos: ' + nftUsernames);      
    //alert('Funcion lista NFTS OK :');


  } catch (error) {


    // Otro manejo de errores si es necesario
      console.error("Error al buscar NFTs:", error);
      //alert('Error lista NFTS'); 
   
  }
}



















// Suponiendo que ya has definido la instancia del contrato como `contractPROFILE`

async function approveAndAction(nftusernameselected, username,action) {

  try {  

      if (action !== 'unfollow') {
        // Aprobar el gasto de CAW por el contrato de perfil
        await approveCAWSpending(action);
        // Esperar un tiempo (puedes ajustar este tiempo según lo que necesites)
        await new Promise(resolve => setTimeout(resolve, 3000));
        // Seguir al usuario
      }
        

        await actionUser(nftusernameselected, username,action);
  
  } catch (error) {
        console.error('Error en el proceso de aprobación y seguimiento:', error);
        // Realiza acciones adicionales en caso de error
  }
       
}
      



async function actionUser(follower, following, action) {
  try {
    const accounts = await web3.eth.getAccounts();
    const myAddress = accounts[0];

    const contract = new web3.eth.Contract(Profile_ContractABI, profileContractAddress);

    const signatureToUser = '0xabcdef1234567890fedcba0987654321abcdef1234567890fedcba0987654321';
    //const timestamp = Date.now();
    const timestamp = 0;
  
    let result;
  
    if (action === 'like') {
      // Realizar acciones para 'like' si es necesario
      console.log('Acción like realizada si es necesario');
    } else if (action === 'follow') {
      result = await contract.methods.follow(follower, following, timestamp, signatureToUser).send({from: myAddress, gas: 300000, gasPrice: web3.utils.toWei('50', 'gwei') });
    } else if (action === 'unfollow') {
      
      result = await contract.methods.unfollow(follower, following).send({from: myAddress, gas: 300000, gasPrice: web3.utils.toWei('50', 'gwei') });
    } else if (action === 'publisher') {
      // Realizar acciones para 'publisher' o 'share' si es necesario
      console.log('Acción publisher o share realizada si es necesario');
    } else if (action === 'share') {
      // Realizar acciones para 'publisher' o 'share' si es necesario
      console.log('Acción publisher o share realizada si es necesario');
    } 
    else {
      console.error('Tipo no válido');
      return;
    }

    console.log('Transacción exitosa:', result);
    // Realizar acciones adicionales si es necesario después de seguir al usuario
  } catch (error) {
    console.error('Error al seguir al usuario:', error);
    // Realizar acciones en caso de error
  }
}

   

async function approveCAWSpending(action) {
  try {
    const accounts = await web3.eth.getAccounts();
    const myAddress = accounts[0];
           
    let amountToApprove = 0;

    // Asignar el monto a aprobar según el tipo
    if (action === 'like') {
      amountToApprove = web3.utils.toWei('2000', 'ether');
    } else if (action === 'follow') {
      amountToApprove = web3.utils.toWei('30000', 'ether');
    } else if (action === 'unfollow') {
      amountToApprove = web3.utils.toWei('0', 'ether');
    } else if (action === 'publisher') {
      amountToApprove = web3.utils.toWei('5000', 'ether');
    } else if (action === 'share') {
      amountToApprove = web3.utils.toWei('4000', 'ether');
    } else {
      // Manejar un tipo desconocido o incorrecto
      console.error('Tipo no válido');
      return;
    }


    // Crear instancia del contrato del token CAW
    const tokenContract = new web3.eth.Contract(CAW_tokenABI, tokenContractAddress);
    showSuccess('aprobacion: ' +action+amountToApprove);      
    // Aprobar al contrato del perfil para gastar el CAW
    await tokenContract.methods.approve(transferContractAddress, amountToApprove).send({from: myAddress, gas: 300000, gasPrice: web3.utils.toWei('50', 'gwei') });
          
    console.log('Aprobación de gasto de CAW realizada con éxito');
    // Realiza acciones adicionales si la aprobación es exitosa
  } catch (error) {
    console.error('Error al aprobar el gasto de CAW:', error);
    // Realiza acciones en caso de error
  }
}













async function createActionPublication(receiverNFTUsername,publication_id,type_action){

 
  console.error('createActionPublication');
  // Obtener la dirección de la cuenta conectada
  const accounts = await web3.eth.getAccounts();
  const myAddress = accounts[0];

  const contract = new web3.eth.Contract(Profile_ContractABI, profileContractAddress);

  const selectorNFTs = document.getElementById('selector_NFTs').value;
  const nftusername = selectorNFTs.replace('@CAW', '');
   
  const loadingAnimationPublication = document.getElementById('loadingAnimation-publication');
  loadingAnimationPublication.style.display = 'block'; // Oculta la animación

  try {         

     
    
    let amountToApprove = 0;
    if(type_action==="publication"){     
               
        amountToApprove = web3.utils.toWei('5000', 'ether');
    }
    else if (type_action==="like") {
          amountToApprove = web3.utils.toWei('2000', 'ether');
    }
    else if (type_action==="share") {
           amountToApprove = web3.utils.toWei('4000', 'ether');
    }else{

    }

   
    // Crear instancia del contrato del token CAW
    //loadingAnimationPublication.style.display = 'none'; // Oculta la animación
    

    const tokenContract = new web3.eth.Contract(CAW_tokenABI, tokenContractAddress);
        
    // Aprobar al contrato del perfil para gastar el CAW
    await tokenContract.methods.approve(transferContractAddress, amountToApprove).send({from: myAddress, gas: 300000, gasPrice: web3.utils.toWei('50', 'gwei') });          
    
    
    // Realiza acciones adicionales si la aprobación es exitosa
  } catch (error) {
    console.error('Error al aprobar el gasto de CAW:', error);
    loadingAnimationPublication.style.display = 'none'; // Oculta la animación
    
    // Realiza acciones en caso de error
  }

    await new Promise(resolve => setTimeout(resolve, 1000)); 

  try {
    
    const contractPUBLICATION = new web3.eth.Contract(Publisher_ContractABI, publisherContractAddress);
    const signatureToUser = '0xabcdef1234567890fedcba0987654321abcdef1234567890fedcba0987654321';
    const timestamp = 0;    

     const type_post = 0;//m,ainpost
     const parentPublicationId=0;     
     const content = document.getElementById('publicacion').value;
     const linkToMedia = document.getElementById('media-publication').value;
     const filterPrivacidad = document.getElementById('filter-privacidad').value;
    
     const jsonMetadata = {
            "linkToMedia": linkToMedia,
            "filterPrivacidad": filterPrivacidad
         };

     const jsonString = JSON.stringify(jsonMetadata);


    if(type_action==="publication"){
       
        loadingAnimationPublication.style.display = 'block'; // Muestra la animación al e    
        //alert("alerta publicacion "+nftusername+timestamp+signatureToUser+content+
          //jsonString+type_post+parentPublicationId);
        await contractPUBLICATION.methods.createPublication(nftusername,timestamp,signatureToUser,content,
          jsonString,type_post,parentPublicationId).send({from: myAddress, gas: 600000, gasPrice: web3.utils.toWei('50', 'gwei') });
   
       
    }
    else if (type_action==="like") {

      await contractPUBLICATION.methods.addReaction(nftusername, receiverNFTUsername,timestamp, signatureToUser,publication_id ).send({from: myAddress, gas: 300000, gasPrice: web3.utils.toWei('50', 'gwei') }); 

    
    }
    else if (type_action==="share") {
         await contractPUBLICATION.methods.sharePublication(nftusername, receiverNFTUsername,timestamp, signatureToUser,publication_id ).send({from: myAddress, gas: 300000, gasPrice: web3.utils.toWei('50', 'gwei') });

    }else{

      showSuccess('Error to Action .');

    }

    
   
   
   
   loadingAnimationPublication.style.display = 'none'; // Oculta la animación
   $('#myModal_publication').modal('hide');

   await getProfile();



  } catch (error) {
    loadingAnimationPublication.style.display = 'none'; // Oculta la animación
    showSuccess('Error to crearte Publication .');
  
  }  

}

async function createActionResponse(content_response,publication_id){

 
  const accounts = await web3.eth.getAccounts();
  const myAddress = accounts[0];
  
  const selectorNFTs = document.getElementById('selector_NFTs').value;
  const nftusername = selectorNFTs.replace('@CAW', '');
      
  const contractPUBLICATION = new web3.eth.Contract(Publisher_ContractABI, publisherContractAddress);
     
  const parentPublicationId=publication_id;

  const content = content_response;
  const linkToMedia = "";
  const filterPrivacidad = "";
    
  const jsonMetadata = {
            "linkToMedia": linkToMedia,
            "filterPrivacidad": filterPrivacidad
  };

  const jsonString = JSON.stringify(jsonMetadata);
  


       
  //alert('createPublicationResponse.' + jsonString+"    "+jsonMetadata);
  try {
     await contractPUBLICATION.methods.createPublicationResponse(nftusername,content,jsonMetadata,parentPublicationId).send({from: myAddress, gas: 300000, gasPrice: web3.utils.toWei('50', 'gwei') });
   
  } catch (error) {    
    showSuccess('Error to crearte Publication.');
  
  }  

}


async function getSmartUserPublications(username, type_user) {

  const selectorNFTs = document.getElementById('selector_NFTs').value;
  const nftUsername = selectorNFTs.replace('@CAW', '');
  //alert("nftusername  "+ nftusername);

  let userPublicationContainer=""
  let vectorNftUsername=[];

  if(type_user==="user"){
    userPublicationContainer = document.querySelector('.user-publication-container');
    userPublicationContainer.innerHTML = "";
    //alert('Publication X '+ username);
    vectorNftUsername.push(username);
    //alert('getSmartUserPublications(nftusername,"user");' + vectorNftUsername); 
    

  } else{
    userPublicationContainer = document.querySelector('.user-following-publication-container');
    //alert('Publication Xxx '+ username);
    userPublicationContainer.innerHTML = "";
    vectorNftUsername=username;
  }

 



  const accounts = await web3.eth.getAccounts();
  const myAddress = accounts[0];
  

for (let user of vectorNftUsername) {
  //alert('Publication For user X '+ user);

  //const selectorNFTs = document.getElementById('selector_NFTs').value;
  //const nftUsername = selectorNFTs.replace('@CAW', '');

  //////nftUsername=user;

  try {
    
    const contractPROFILE = new web3.eth.Contract(Profile_ContractABI, profileContractAddress);
    //const profileText = await contractPROFILE.methods.getProfile(user).call();
    //const profile = JSON.parse(profileText);
    //profile_picture_publication=profile.fotoPerfil;
    //profile_name=profile.nombre;
    //alert('getSmartUserPublications(nftusername,"user");' + user+profile.nombre); 
    
    

    const contractPUBLICATION = new web3.eth.Contract(Publisher_ContractABI, publisherContractAddress);
    const count = await contractPUBLICATION.methods.getUserTotalPublicationsCount(user).call();

    let count_like,count_share,count_comment,user_like,user_share,user_comment;

    for (let i = 0; i < count; i++) {
     const result = await contractPUBLICATION.methods.getUserPublication(user, i).call();

     const profileText = await contractPROFILE.methods.getProfile(result[0]).call();
     const profile = JSON.parse(profileText);
     profile_picture_publication=profile.fotoPerfil;
     profile_name=profile.nombre;
     //alert('getSmartUserPublications(nftusername,"user");' + user+profile.nombre); 
     


       //llama a las funciones que ponen los likes y los shares
      count_like = await contractPUBLICATION.methods.getLikesCountByPublication(result[1]).call();
      count_share = await contractPUBLICATION.methods.getSharesCountByPublication(result[1]).call(); 
      count_comment = await contractPUBLICATION.methods. getCommentCount(result[1]).call(); 
     

      user_like = await contractPUBLICATION.methods.getUserLikeStatusByPublication(nftUsername,result[1]).call();
      user_share = await contractPUBLICATION.methods.getUserShareStatusByPublication(nftUsername,result[1]).call(); 
      user_comment = await contractPUBLICATION.methods.getUserCommentStatusByPublication(nftUsername,result[1]).call(); 
      
     
     

       try{
      //Convierte la cadena JSON a un objeto JavaScript
      let linkToMedia; 
      let filterPrivacidad;

       
       //const jsonMetadata = JSON.parse(result[3]);
       //let  linkToMedia=""
       //let filterPrivacidad=""
      
       let jsonMetadata;
       try{      
        jsonMetadata = JSON.parse(result[3]);
        linkToMedia = jsonMetadata.linkToMedia;
        filterPrivacidad = jsonMetadata.filterPrivacidad;
      }catch{
         linkToMedia = '';
         filterPrivacidad = '';
      }

    
       
      

      const publication_username =result[0];
      const publication_ID =result[1];
      const content_publication = result[2];      
      const timestamp = result[4];
      const publication_Type=result[5];

      const publication_date = tiempoTranscurrido(timestamp);                                                  

     //alert('Publication:g '+ publication_Type);
      //alert('Publication:g '+publication_ID+ publication_username+content_publication+ timestamp+filterPrivacidad+linkToMedia);
      
      
      const userPublicationGroup = document.createElement('div');
      userPublicationGroup.classList.add('user-publication-group');
      userPublicationGroup.addEventListener('click', () => {
        // Acción al hacer clic en la publicación completa
        // Por ejemplo, ver más detalles o redireccionar a una página
      });
      userPublicationGroup.style.width = '100%'; // Ocupar el ancho completo del contenedor principal
      userPublicationGroup.style.border = '2px solid #ccc'; // Ejemplo de borde para mostrar el contenedor
      userPublicationGroup.style.display= "inline-block";
      userPublicationGroup.style.marginTop = '10px';
      userPublicationGroup.style.borderRadius="20px"
      
       const userPublicationId = document.createElement('div');
       userPublicationId.classList.add('user-publication-id');
       userPublicationId.innerHTML = `ID: ${publication_ID}`;
       userPublicationId.style.display= "inline-block";


       const imageLink = document.createElement('a');
       imageLink.href = 'URL_DE_DESTINO'; // Coloca la URL a la que quieres redirigir al hacer clic en la imagen



       const roundImage = document.createElement('img');
       roundImage.src = profile_picture_publication; // Inserta la URL de la imagen que deseas mostrar
       roundImage.style.borderRadius = '50%'; // Para crear una imagen redonda
       roundImage.style.width = '60px'; // Establece el ancho de la imagen
       roundImage.style.height = '60px'; // Establece la altura de la imagen
       roundImage.style.marginRight = '15px'; // Añade margen derecho
       roundImage.style.marginLeft = '15px';
       roundImage.style.display= "inline-block";
       roundImage.style.marginTop= "10px";
       roundImage.style.marginBottom= "20px";
       // Agrega la imagen redonda al enlace
       imageLink.appendChild(roundImage);

      // Agrega el enlace con la imagen redonda al contenedor 'userPublicationId'
      


      const usernamePublication = document.createElement('div');
      usernamePublication.classList.add('user-publication-id');
      usernamePublication.innerHTML = profile_name;
      usernamePublication.style.marginRight = '15px'; // Añade margen derecho
      usernamePublication.style.fontSize = '1.5em'; // Tamaño de letra más grande
      usernamePublication.style.display= "inline-block";

      
      const nftusernamePublication = document.createElement('div');
      nftusernamePublication.classList.add('user-publication-id');
      nftusernamePublication.innerHTML ="@"+publication_username;
      nftusernamePublication.style.marginRight = '15px'; // Añade margen derecho
      nftusernamePublication.style.display= "inline-block";


      const userPublicationDate = document.createElement('div');
      userPublicationDate.classList.add('user-publication-id');
      userPublicationDate.innerHTML =publication_date;
      userPublicationDate.style.display= "inline-block";
   
  
      

const userPublication = document.createElement('div');
userPublication.classList.add('user-publication');
userPublication.style.width = '100%'; // Ocupar el ancho completo del contenedor principal
userPublication.style.fontSize = '1.2em'; // Tamaño de letra más grande
userPublication.style.marginBottom = "20px";
userPublication.style.wordWrap = 'break-word'; // Envolver el texto si es demasiado largo
userPublication.style.whiteSpace = 'pre-line'; // Mantener los saltos de línea del texto original  

const words = content_publication.split(/(P\S+|r\S+|\s+)/); // Divide el contenido


words.forEach(word => {
  const span = document.createElement('span');

  if (word.startsWith('@')) {
    span.style.color = 'blue'; // Colorear las palabras que comienzan con @
    span.innerText = word;
    span.style.fontWeight = 'bold'; // Hacer la letra más gruesa (negrita)
    span.addEventListener('click', () => {
      // Acción al hacer clic en una palabra que comienza con @
    });
  } else if (word.startsWith('#')) {
    span.style.color = 'green'; // Colorear las palabras que comienzan con #
    span.style.fontWeight = 'bold'; // Hacer la letra más gruesa (negrita)
    span.innerText = word;
    span.addEventListener('click', () => {
      // Acción al hacer clic en una palabra que comienza con #
    });
  } else if (word === ' ') {
    // Preserva el espacio entre las palabras
    span.innerHTML = '&nbsp;';
  } else {
    span.innerText = word;
  }

  userPublication.appendChild(span);
});
    

      const userPublicationImage = document.createElement('img');
      userPublicationImage.classList.add('user-publication-image');
      userPublicationImage.src = linkToMedia;
      userPublicationImage.style.borderRadius = '15px'; // Redondear las esquinas
      userPublicationImage.style.width = '100%'; // Expandir la imagen al ancho del contenedor
     
      // ... Crear y configurar otros elementos para mostrar la información

      const publicationIconsGroup = document.createElement('div');
      publicationIconsGroup.classList.add('publication-icons-group');
      publicationIconsGroup.style.width = '100%'; // Ocupar el ancho completo del contenedor principal
      publicationIconsGroup.style.textAlign = 'center'; // Alinear elementos al centro
      publicationIconsGroup.style.marginTop = "10px";
 
  const comentPublicationGroup = document.createElement('div');
       comentPublicationGroup.classList.add('publication-icons-group');
       comentPublicationGroup.style.width = '100%'; // Ocupar el ancho completo del contenedor principal
       comentPublicationGroup.style.textAlign = 'center'; // Alinear elementos al centro
       comentPublicationGroup.style.marginTop = "10px";



// Crear el enlace (<a>) con HTML directamente
const retweetIcon = document.createElement('a');
retweetIcon.href = '#'; // Puedes establecer el enlace que desees
if (user_share){
   retweetIcon.innerHTML = `<span class="glyphicon glyphicon-retweet" style="font-size: 2em; color: green; margin-left: 20px;"></span>&nbsp; ${count_share}`;
}else{
  retweetIcon.innerHTML = `<span class="glyphicon glyphicon-retweet" style="font-size: 2em; color: black; margin-left: 20px;"></span>&nbsp; ${count_share}`;

}
// Agregar el evento de clic al enlace
retweetIcon.addEventListener('click', () => {
  // Acción al hacer clic en el enlace
  createActionPublication(publication_username,publication_ID,"share");
  //alert('¡Hiciste clic en el enlace!');
});







// Crear el enlace (<a>) con HTML directamente
const heartIcon = document.createElement('a');
heartIcon.href = '#'; // Puedes establecer el enlace que desees

if (user_like){
   heartIcon.innerHTML = `<span class="glyphicon glyphicon-heart" style="font-size: 2em; color: red; margin-left: 50px;"></span>&nbsp; ${count_like}`;
}else{
  heartIcon.innerHTML = `<span class="glyphicon glyphicon-heart-empty" style="font-size: 2em; color: black; margin-left: 50px;"></span>&nbsp; ${count_like}`;
}

// Agregar el evento de clic al enlace
heartIcon.addEventListener('click', () => {
  // Acción al hacer clic en el enlace
  createActionPublication(publication_username,publication_ID,"like");
  //alert('¡Hiciste clic en el enlace!');
});



 //alert('comment XX '+user_comment+ " " + count_comment ); 
// Crear el enlace (<a>) con HTML directamente
const commentIcon = document.createElement('a');
commentIcon.href = '#'; // Puedes establecer el enlace que desees

if (user_comment){
     commentIcon.innerHTML = `<span class="glyphicon glyphicon-comment" style="font-size: 2em; color: blue; margin-left: 50px;"></span>&nbsp; ${count_comment}`;
}else{
  commentIcon.innerHTML = `<span class="glyphicon glyphicon-comment" style="font-size: 2em; color: black; margin-left: 50px;"></span>&nbsp; ${count_comment}`;
}

// Agregar el evento de clic al enlace
commentIcon.addEventListener('click', () => {
  // Acción al hacer clic en el enlace
  //alert('¡Hiciste clic en el enlace!');
    getresponses(publication_ID); 
    $('#myModal-responses').modal('show');
});


////////////comentarios///////////////////////////////////////////////////////
// Crear la entrada de texto dinámicamente
    
    const commentTextArea = document.createElement('textarea');
    commentTextArea.placeholder = 'Comment publication here';
    commentTextArea.style = 'border: 2px solid black; border-radius: 10px; width: 100%; margin-bottom: 0px; height: 40px; resize: true;';      


    // Crear el enlace (<a>) con HTML directamente
const commentButtonIcon = document.createElement('a');
commentButtonIcon.href = '#'; // Puedes establecer el enlace que desees
commentButtonIcon.innerHTML = `<span class="glyphicon glyphicon-send" style="font-size: 2em; color: lime; margin-left: 50px;"></span>&nbsp; `;
// Agregar el evento de clic al enlace
commentButtonIcon.addEventListener('click', () => {
  // Acción al hacer clic en el enlace
      const textoIngresado =  commentTextArea.value;
      //(`Texto ingresado: ${textoIngresado}`);
      
      createActionResponse(commentTextArea.value,publication_ID);

      //createActionPublication(publication_username,publication_ID,"like");
      // Otra lógica para procesar el texto según tus necesidades
      // ...

      // Limpiar la entrada de texto después de procesar
      commentTextArea.value = '';
});



//////////////////////////////////////////////////////////////////   



     
      // Agregar elementos al contenedor de iconos

      publicationIconsGroup.appendChild(retweetIcon);     
      publicationIconsGroup.appendChild(heartIcon);
      publicationIconsGroup.appendChild(commentIcon);
      publicationIconsGroup.appendChild(commentButtonIcon);
       

      comentPublicationGroup.appendChild(commentTextArea);
      




      // Agregar todos los elementos al contenedor de la publicación
      //userPublicationGroup.appendChild(userPublicationId);
      userPublicationGroup.appendChild(imageLink);
      userPublicationGroup.appendChild(usernamePublication);
      userPublicationGroup.appendChild(nftusernamePublication);
      userPublicationGroup.appendChild(userPublicationDate);  

      userPublicationGroup.appendChild(userPublication);
      userPublicationGroup.appendChild(userPublicationImage);
       userPublicationGroup.appendChild(comentPublicationGroup);
      userPublicationGroup.appendChild(publicationIconsGroup);
      


      // Agregar la publicación al contenedor principal
      //solo se muestran las publicaciones, las respuestas no se muewstran
      if (publication_Type==="0"){
          userPublicationContainer.appendChild(userPublicationGroup);
      }
      // Agregar espacio entre publicaciones
      userPublicationContainer.appendChild(document.createElement('br'));
     
///##     userPublicationContainer.style.display="block"; 



      } catch (error) {
          console.error('Error al obtener las publicaciones:', error.message);
      }




    }
  } catch (error) {
    console.error('Error al obtener las publicaciones:', error.message);
  }



}




}


 function tiempoTranscurrido(timestamp) {

  timestamp=timestamp*1000;
  const diferencia = Date.now() - timestamp;
  const segundos = Math.floor(diferencia / 1000);
  const minutos = Math.floor(segundos / 60);
  const horas = Math.floor(minutos / 60);
  const dias = Math.floor(horas / 24);

  if (segundos < 60) {
    return 'Hace unos segundos';
  } else if (minutos < 60) {
    return `Hace ${minutos} ${minutos === 1 ? 'minuto' : 'minutos'}`;
  } else if (horas < 24) {
    return `Hace ${horas} ${horas === 1 ? 'hora' : 'horas'}`;
  } else {
    const fecha = new Date(timestamp);
    return fecha.toLocaleDateString('es-ES', { year: 'numeric', month: 'long', day: 'numeric' });
  }
}     
         


          // Funciones para mostrar mensajes en la página

           function showSuccess(message) {
            const successElement = document.getElementById('success-message');
            successElement.innerText = message;
          } 
          function showSuccess(message) {
            const successElement = document.getElementById('success-message');
            successElement.innerText = message;
          }

          function showError(message) {
            const errorElement = document.getElementById('error-message');
            errorElement.innerText = message;
          }

          function showBalance(balance) {
            const balanceElement = document.getElementById('saldo');
            balanceElement.innerText = 'Saldo: ' + balance;
          }

/* async function tokensFree(token) {
  try {
    const accounts = await web3.eth.getAccounts();
    const myAddress = accounts[0];
    const contractFREETOKENS = new web3.eth.Contract(FreeTokens_ContractABI, freeTokensContractAddress);



    if (token === "CAW") {
      //const balanceCAW = await contractFREETOKENS.methods.balanceOfCAW(myAddress).call();
      //if (balanceCAW <= 2000) {
        const transaction = await contractFREETOKENS.methods.requestTokensCaw().send({from: myAddress, gas: 300000, gasPrice: web3.utils.toWei('50', 'gwei') }); 
        
        //console.log('Transacción exitosa:', transaction);
      //} else {
        //  console.log('El usuario ya tiene suficientes tokens CAW.');
      
    } else {
      const balanceEther = await web3.eth.getBalance(myAddress);
      if (balanceEther <= web3.utils.toWei('0.0001', 'ether')) {
        const transaction = await contractFREETOKENS.methods.conectar().send({from: myAddress, gas: 300000, gasPrice: web3.utils.toWei('50', 'gwei') });       
        console.log('Transacción exitosa:', transaction);
      } else {
        console.log('El usuario tiene Ether.');
      }
    }
  } catch (error) {
    console.error('Error al realizar la transacción:', error);
    alert('Error al realizar la transacción: ' + error.message);
  }
}





async function sendETHtowallet(){

    const accounts = await web3.eth.getAccounts();
    const myAddress = accounts[0];
    const contractFREETOKENS = new web3.eth.Contract(FreeTokens_ContractABI, freeTokensContractAddress);
    
    const walletelement = document.getElementById('text-address-to-send-ETH');      
    const friendAddress=walletelement.value;

    alert('friendAddress  '+ friendAddress);

    const balanceEther = await web3.eth.getBalance(friendAddress); 
    
    if (balanceEther <= web3.utils.toWei('0.0', 'ether')) {
          try{
             const transaction = await contractFREETOKENS.methods.send({from: myAddress, gas: 300000, gasPrice: web3.utils.toWei('50', 'gwei') });      
          }catch{
               console.error('Error al realizar la transacción:', error);
          } 
    }else{
      alert('El usuario ya posee ETHER');

      console.log('El usuario tiene Ether.');
    }


    walletelement.innerHTML = '';

}

 */
    

          // Otros botones y acciones
          // ...

//function getFollowing(string memory nftusername) public view returns (string[] memory) {
//function getFollowingTime(string memory follower, string memory following) public view returns (uint256) {
//function getFollowingCount(string memory nftusername) public view returns (uint256) {
//function getProfileTime(string memory nftusername) public view returns (uint256) {
//function getProfileCount() public view returns (uint256) {
//function profileExists(string memory nftusername) private view returns (bool) {
//function isFollowing(string memory follower, string memory following) public view returns (bool) {
    
async function verifymintearNFT(){

    // Obtener la dirección de la cuenta conectada
    //const accounts = await web3.eth.getAccounts();
    //const myAddress = accounts[0];
    //const contractNFT = new web3.eth.Contract(NFT_ContractABI, nftContractAddress);

    const nftusername = document.getElementById('text-mintear-nft').value;
    const bottonMint = document.getElementById('btn-mintear-nft');
    const bottonVerifyMint = document.getElementById('btn-verify-nft');
    const errorDisplay = document.getElementById('Error_Minted_username');
    const readyDisplay = document.getElementById('Minted_username');

    let isMintedNFT;
    if (nftUsernameContract.methods) {
                 console.log("Con MetaMask ");
                 // Usando web3.js
                 isMintedNFT = await nftUsernameContract.methods.isMinted(nftusername).call();
    } else {
                 // Usando ethers.js
                console.log("Con SockWallet "); 
                isMintedNFT = await nftUsernameContract.isMinted(nftusername); 
    }
      
    
    if(isMintedNFT){

       errorDisplay.style.display = 'block';
       readyDisplay.style.display = "none"
       errorDisplay.textContent = 'The username is not available!.';
             

    }else{
       errorDisplay.style.display = 'none';
       readyDisplay.style.display = "block"
       readyDisplay.textContent= "The username is For You! :) "
       bottonMint.style.display = 'block';
       bottonVerifyMint.style.display = 'none';
    }



}    
   

</script>

<script>
const inputField = document.getElementById('text-mintear-nft');
const output = document.getElementById('mount-minteo');
const errorDisplay = document.getElementById('Error_Minted_username');
const bottonMint = document.getElementById('btn-mintear-nft');

const bottonVerifyMint = document.getElementById('btn-verify-nft');



function isValidNFTUsername(username) {
  return /^[a-z0-9]+$/.test(username);
}


inputField.addEventListener('input', function() {
  const enteredText = inputField.value.trim();
  const count = enteredText.length;
  const saldoCaw = parseFloat(document.getElementById('saldo_CAW').textContent);
  bottonMint.style.display = 'none';
  bottonVerifyMint.style.display = 'block';
  
  if (!isValidNFTUsername(enteredText)) {
    errorDisplay.style.display = 'block';
    errorDisplay.textContent = 'Only lowercase letters and numbers are valid.';
    output.textContent = '';
    //bottonMint.style.display = 'none';
    
  } else {
    errorDisplay.style.display = 'none';
    //bottonMint.style.display = 'block';

    let maticNeeded = 0;
    if (count >= 8) {
      maticNeeded = 8;
    } else if (count === 1) {
      maticNeeded = 36;
    } else {
      switch (count) {
        case 2:
          maticNeeded = 29;
          break;
        case 3:
          maticNeeded = 23;
          break;
        case 4:
          maticNeeded = 18;
          break;
        case 5:
          maticNeeded = 14;
          break;
        case 6:
          maticNeeded = 11;
          break;
        case 7:
          maticNeeded = 9;
          break;
      }
    }

    if (saldoCaw < maticNeeded) {
      output.textContent = `${maticNeeded}`
      output.style.fontSize = '24px'; // Cambia el tamaño de fuente
      output.style.color = 'white'; // Cambia el color`ID: ${publication_ID}`;
      //bottonMint.style.display = 'none';
    } else {
      output.textContent = `${maticNeeded}`;
      output.style.fontSize = '24px'; // Cambia el tamaño de fuente
      output.style.color = 'red'; // Cambia el color
      errorDisplay.textContent="Insufficient MATIC balance"
      //bottonMint.style.display = 'block';
    }
  }
});

</script>
  
<script>
const textArea = document.getElementById('publicacion');
const charCount = document.getElementById('char-count');
const butonPublication=document.getElementById('btn-publication')

textArea.addEventListener('input', function() {
    // Obtener el conteo de caracteres restantes
    const maxLength = 420;
    const remaining = maxLength - textArea.value.length;

  
    

    // Mostrar el conteo solo cuando sea 21 o menos, o si se ha superado el límite
    if (remaining <= 31 || remaining < 0) {
        charCount.textContent = remaining < 0 ? '0' : remaining;
    } else {
        charCount.textContent = ''; // Si hay más de 21 caracteres restantes, oculta el conteo
    }

    

    if (remaining < 0){
        butonPublication.style.display='none';
    }else{
        butonPublication.style.display='block';
    }
    

    
});

</script>  


<script>
  // Busca y colorea los caracteres @ y #
const postText = document.getElementById('postText');
const text = postText.innerHTML;
const modifiedText = text
    .replace(/@(\S+)/g, '<span class="atSymbol">@$1</span>')
    .replace(/#(\S+)/g, '<span class="hashtag">#$1</span>');
postText.innerHTML = modifiedText;

// Revisar si hay un enlace de imagen o video
const mediaContent = document.getElementById('mediaContent');
const linkToMedia = 'https://pbs.twimg.com/profile_banners/3359503481/1691164787/1500x500'; // Ejemplo de enlace a imagen
const linkToVideo = 'https://youtu.be/8DWeaY3EROE'; // Ejemplo de enlace a video

// Verificar si es una imagen
if (/\.(jpeg|jpg|gif|png)$/.test(linkToImage)) {
    mediaContent.innerHTML = `<img src="${linkToImage}" alt="Imagen">`;
} else {
    mediaContent.innerHTML = 'No se encontró imagen';
}

//if (linkToMedia.endsWith('.jpg') || linkToMedia.endsWith('.png') || linkToMedia.endsWith('.gif')) {
    // Muestra la imagen
//    mediaContent.innerHTML = `<img src="${linkToMedia}" alt="Imagen">`;
//} else if (linkToMedia.endsWith('.mp4') || linkToMedia.endsWith('.avi') || linkToMedia.endsWith('.mov')) {
    // Muestra el video
//    mediaContent.innerHTML = `<video controls><source src="${linkToVideo}" type="video/mp4"></video>`;
//}
</script>

 <script>
          function myFunctionbtc() {
            // Crea un área de texto temporal para copiar el contenido
            var areaDeTextoTemp = document.createElement("textarea");
            areaDeTextoTemp.value = globalWalletKey;

            // Agrega el área de texto temporal al documento
            document.body.appendChild(areaDeTextoTemp);

            // Selecciona el contenido del área de texto
            areaDeTextoTemp.select();
            areaDeTextoTemp.setSelectionRange(0, 99999); // Para dispositivos móviles

            // Intenta copiar el contenido al portapapeles
            document.execCommand("copy");

            // Elimina el área de texto temporal ya que ya no es necesaria
            document.body.removeChild(areaDeTextoTemp);

            // Muestra el mensaje de "Copiado!" en el botón
            var btnCopyKey = document.getElementById("btn-copy-key");
            var originalContent = btnCopyKey.innerHTML;
            btnCopyKey.innerHTML = "<font color='white'>¡Copiado!</font>";

            // Vuelve al estado original después de 2 segundos
            setTimeout(function() {
                btnCopyKey.innerHTML = originalContent;
            }, 2000);
        }
          
          
          </script>

<script>
 

  
 function generarCodigoQR() {
        var divElement = document.getElementById("addres-wallet");
        var divElementQR = document.getElementById("addres-wallet-QR");
        divElementQR.innerText="";

        if (divElement) {
          var walletAddress = globalWalletKey.trim();
          var qrcode = new QRCode(divElementQR, {
            text: walletAddress,
            width: 256,
            height: 256,
          });
        } else {
          console.error("Elemento no encontrado: addres-wallet");
        }
  }

</script>





<script src="bootstrap/js/jquery.min.js" ></script>
<script src="bootstrap/js/bootstrap.min.js"></script>

</body>
</html>